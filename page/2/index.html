<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Python-学习2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/03/Python-%E5%AD%A6%E4%B9%A02/" class="article-date">
  <time datetime="2020-05-03T12:19:56.000Z" itemprop="datePublished">2020-05-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/03/Python-%E5%AD%A6%E4%B9%A02/">Python 学习2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Python-if，while-for循环"><a href="#Python-if，while-for循环" class="headerlink" title="Python-if，while, for循环"></a>Python-if，while, for循环</h1><h2 id="key-points"><a href="#key-points" class="headerlink" title="key points"></a>key points</h2><h3 id="if语句，及if语句套用"><a href="#if语句，及if语句套用" class="headerlink" title="if语句，及if语句套用"></a>if语句，及if语句套用</h3><ol>
<li>if…else</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">name=input()  <span class="comment">#显示输入框，name=输入内容 show the inputbox，name=input #input 函数</span></span><br><span class="line"><span class="keyword">if</span> name == <span class="string">'Mary'</span>:               <span class="comment">#if 语句</span></span><br><span class="line">    print(<span class="string">'Hello Mary'</span>)</span><br><span class="line">    password=input()</span><br><span class="line">    <span class="keyword">if</span> password == <span class="string">'swordfish'</span>:</span><br><span class="line">        print(<span class="string">'Access granted.'</span>)</span><br><span class="line">    <span class="keyword">else</span>:                        <span class="comment">#if...else语句           </span></span><br><span class="line">        print(<span class="string">'Wrong password.'</span>)</span><br></pre></td></tr></table></figure>

<p>该代码可判断用户名及密码是否与设定值相符</p>
<p>check the user‘s name and password</p>
<ol start="2">
<li>if…elif</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">name=input()</span><br><span class="line"><span class="keyword">if</span> name == <span class="string">'Alice'</span>:</span><br><span class="line">    print(<span class="string">'Hi,Alice.'</span>)  </span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'What is your age?'</span>)</span><br><span class="line">    age=input()</span><br><span class="line">    <span class="keyword">if</span> age &lt; <span class="string">'12'</span>:</span><br><span class="line">        print(<span class="string">'You are not Alice, kiddo.'</span>)</span><br><span class="line">    <span class="keyword">elif</span> age &gt; <span class="string">'100'</span>:</span><br><span class="line">        print(<span class="string">'You are not Alice,grannie.'</span>)</span><br><span class="line">    <span class="keyword">elif</span> age &gt; <span class="string">'2000'</span>:</span><br><span class="line">        print(<span class="string">'Unlike you, Alice is not an undead, immortal vampire.'</span>)</span><br></pre></td></tr></table></figure>

<p>该代码通过判断年龄确定身份</p>
<p>check the user through age</p>
<h3 id="while语句"><a href="#while语句" class="headerlink" title="while语句"></a>while语句</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spam = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> spam &lt; <span class="number">5</span>:</span><br><span class="line">    print(<span class="string">'Hello world!'</span>)</span><br><span class="line">    spam = spam+<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>output：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<h4 id="‘break’-and-‘continue’"><a href="#‘break’-and-‘continue’" class="headerlink" title="‘break’ and ‘continue’"></a>‘break’ and ‘continue’</h4><p>break:</p>
<p>When the break is executed, the loop ends.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">spam=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(<span class="string">'Hello world'</span>)</span><br><span class="line">    <span class="keyword">if</span> spam==<span class="number">3</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    spam=spam+<span class="number">1</span></span><br><span class="line">print(spam)</span><br><span class="line"></span><br><span class="line"><span class="comment">#out:</span></span><br><span class="line"><span class="comment">#Hello world</span></span><br><span class="line"><span class="comment">#Hello world</span></span><br><span class="line"><span class="comment">#Hello world</span></span><br><span class="line"><span class="comment">#Hello world</span></span><br><span class="line"><span class="comment">#3</span></span><br></pre></td></tr></table></figure>

<p>continue:</p>
<p>When continue is executed, the loop starts again.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">spam=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> spam&lt;<span class="number">4</span>:</span><br><span class="line">    print(<span class="string">'Hello!'</span>)</span><br><span class="line">    spam=spam+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> spam==<span class="number">3</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    print(<span class="string">'Hello world'</span>)</span><br><span class="line">    print(<span class="string">' '</span>)</span><br><span class="line">print(spam)</span><br><span class="line"></span><br><span class="line"><span class="comment">#out:</span></span><br><span class="line"><span class="comment">#Hello!</span></span><br><span class="line"><span class="comment">#Hello world</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#Hello!  during this time, spam=3, so it didn't print 'Hello world'.</span></span><br><span class="line"><span class="comment">#Hello!</span></span><br><span class="line"><span class="comment">#Hello world</span></span><br><span class="line"><span class="comment">#4</span></span><br></pre></td></tr></table></figure>



<h3 id="while-if"><a href="#while-if" class="headerlink" title="while+if"></a>while+if</h3><p>输入密码 input the password</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">key=input() </span><br><span class="line">spam=<span class="number">0</span> <span class="comment">#record the times tried, make sure no more than 3 times 不超过三次</span></span><br><span class="line"><span class="keyword">if</span> int(key)==<span class="number">12345</span>:</span><br><span class="line">        print(<span class="string">'Pass'</span>)</span><br><span class="line"><span class="keyword">while</span> spam &lt; <span class="number">2</span> <span class="keyword">and</span> int(key)!=<span class="number">12345</span>:</span><br><span class="line">            print(<span class="string">'Try again'</span>)</span><br><span class="line">            key=input()</span><br><span class="line">            spam=spam+<span class="number">1</span>  <span class="comment">#计次 record thetimes</span></span><br><span class="line"><span class="keyword">if</span> int(key)==<span class="number">12345</span> <span class="keyword">and</span> spam!=<span class="number">0</span>:</span><br><span class="line">        print(<span class="string">'Pass'</span>)</span><br></pre></td></tr></table></figure>

<p>e.g.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;1</span><br><span class="line">Try again</span><br><span class="line">&gt;12</span><br><span class="line">Try again</span><br><span class="line">&gt;12345</span><br><span class="line">Pass</span><br></pre></td></tr></table></figure>

<p>another way：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">key=input()</span><br><span class="line"><span class="keyword">if</span> key==<span class="string">'12345'</span>:</span><br><span class="line">    print(<span class="string">'pass'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'try again'</span>)</span><br><span class="line">    key=input()</span><br><span class="line">    <span class="keyword">if</span> key==<span class="string">'12345'</span>:</span><br><span class="line">        print(<span class="string">'pass'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'try again'</span>)</span><br><span class="line">        key=input()</span><br><span class="line">        <span class="keyword">if</span> key==<span class="string">'12345'</span>:</span><br><span class="line">            print(<span class="string">'pass'</span>)</span><br></pre></td></tr></table></figure>



<h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">12</span>,<span class="number">16</span>):</span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>

<p>12到16的所有整数</p>
<p>print all integers in 12 to 16</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10</span>,<span class="number">2</span>): <span class="comment">#the 2 here means the step is 2</span></span><br><span class="line">    print(i)</span><br><span class="line"><span class="comment">#out：0 2 4 6 8</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>,<span class="number">-1</span>,<span class="number">-1</span>): </span><br><span class="line">    print(i)</span><br><span class="line"><span class="comment">#output：5 4 3 2 1 0</span></span><br></pre></td></tr></table></figure>



<h2 id="example"><a href="#example" class="headerlink" title="example"></a>example</h2><h3 id="a-tricky-game："><a href="#a-tricky-game：" class="headerlink" title="a tricky game："></a>a tricky game：</h3><p>You must input ‘your name’ instead of the real name:</p>
<p>你要输入 ”your name” 而不是真的名字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'Please type your name.'</span>)</span><br><span class="line">yourname=input()</span><br><span class="line"><span class="keyword">while</span>  yourname!=<span class="string">'your name'</span>:</span><br><span class="line">    print(<span class="string">'Please type your name.'</span>)</span><br><span class="line">    yourname=input()</span><br><span class="line"><span class="keyword">if</span> yourname==<span class="string">'your name'</span>:</span><br><span class="line">    print(<span class="string">'Thank you!'</span>)</span><br></pre></td></tr></table></figure>

<p>e.g.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Please type your name.</span><br><span class="line">Alice</span><br><span class="line">Please type your name.</span><br><span class="line">Emma</span><br><span class="line">Please type your name.</span><br><span class="line">your name</span><br><span class="line">Thank you!</span><br></pre></td></tr></table></figure>

<p>another way:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(<span class="string">'Please type your name.'</span>)</span><br><span class="line">    name=input()</span><br><span class="line">    <span class="keyword">if</span> name == <span class="string">'your name'</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(<span class="string">'Thank you!'</span>)</span><br></pre></td></tr></table></figure>



<h3 id="make-patterns"><a href="#make-patterns" class="headerlink" title="make patterns!"></a>make patterns!</h3><h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">6</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(<span class="string">'*'</span>*a) <span class="comment">#'*'is the string while * is 'x', multiply</span></span><br><span class="line">    a=a<span class="number">-1</span> <span class="comment">#the number of a is decreasing</span></span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment">#if there is no more '*', it ends</span></span><br></pre></td></tr></table></figure>

<p>e.g.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">******</span><br><span class="line">*****</span><br><span class="line">****</span><br><span class="line">***</span><br><span class="line">**</span><br><span class="line">*</span><br></pre></td></tr></table></figure>

<h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(<span class="string">'*'</span>*a) </span><br><span class="line">    a=a+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">6</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(<span class="string">'*'</span>*a)</span><br><span class="line">    a=a<span class="number">-1</span></span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line">**</span><br><span class="line">***</span><br><span class="line">****</span><br><span class="line">*****</span><br><span class="line">******</span><br><span class="line">*****</span><br><span class="line">****</span><br><span class="line">***</span><br><span class="line">**</span><br><span class="line">*</span><br></pre></td></tr></table></figure>

<p>another way</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">7</span>):</span><br><span class="line">    print(<span class="string">'*'</span>*a)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> range(<span class="number">5</span>,<span class="number">0</span>,<span class="number">-1</span>):</span><br><span class="line">    print(<span class="string">'*'</span>*a)</span><br></pre></td></tr></table></figure>

<h3 id="calculation-of-factorial"><a href="#calculation-of-factorial" class="headerlink" title="calculation of factorial"></a>calculation of factorial</h3><p>阶乘计算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">result=<span class="number">1</span></span><br><span class="line">a=int(input())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,a+<span class="number">1</span>):</span><br><span class="line">    result=result*i</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<p>e.g.</p>
<p>input=9</p>
<p>output=362880</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/03/Python-%E5%AD%A6%E4%B9%A02/" data-id="ckbw9eipy000734ur9c6j1se8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">-python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Python-学习1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/03/Python-%E5%AD%A6%E4%B9%A01/" class="article-date">
  <time datetime="2020-05-03T11:24:01.000Z" itemprop="datePublished">2020-05-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/03/Python-%E5%AD%A6%E4%B9%A01/">Python 学习1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Python内置函数"><a href="#Python内置函数" class="headerlink" title="Python内置函数"></a>Python内置函数</h1><p>*一到六载自<a href="https://cloud.tencent.com/developer/article/1200752，经微调，重点加黑" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1200752，经微调，重点加黑</a></p>
<h2 id="数学符号"><a href="#数学符号" class="headerlink" title="*数学符号"></a>*数学符号</h2><table>
<thead>
<tr>
<th>操作符</th>
<th>操作</th>
<th>例子</th>
<th>求职为</th>
</tr>
</thead>
<tbody><tr>
<td>**</td>
<td>指数(^)</td>
<td>2**3</td>
<td>8</td>
</tr>
<tr>
<td>%</td>
<td>取余数(mod)</td>
<td>22%8</td>
<td>6</td>
</tr>
<tr>
<td>//</td>
<td>取商(quotient)</td>
<td>22//8</td>
<td>2</td>
</tr>
<tr>
<td>/</td>
<td>除(divide)</td>
<td>22/8</td>
<td>2.75</td>
</tr>
<tr>
<td>*</td>
<td>乘(multiply)</td>
<td>3*5</td>
<td>15</td>
</tr>
<tr>
<td>-</td>
<td>减(minus)</td>
<td>5-2</td>
<td>3</td>
</tr>
<tr>
<td>+</td>
<td>加(add)</td>
<td>2+2</td>
<td>4</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>符号</th>
<th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>=</td>
<td>赋值</td>
</tr>
<tr>
<td>==</td>
<td>等于(equal to)</td>
</tr>
<tr>
<td>!=</td>
<td>不等(not equal to)</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于等于</td>
</tr>
</tbody></table>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="*数据类型"></a>*数据类型</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>转换符号</th>
<th>例子</th>
</tr>
</thead>
<tbody><tr>
<td>整型（integer）</td>
<td>int()</td>
<td>-2, -1, 0, 1, 2, 3</td>
</tr>
<tr>
<td>浮点型（float）</td>
<td>float()</td>
<td>-1.25, -1.0, –0.5, 1.25</td>
</tr>
<tr>
<td>字符型（string）</td>
<td>str()</td>
<td>‘a’, ‘aa’, ‘Hello!’, ‘11a’</td>
</tr>
</tbody></table>
<h2 id="一、数学运算类"><a href="#一、数学运算类" class="headerlink" title="一、数学运算类"></a>一、数学运算类</h2><table>
<thead>
<tr>
<th align="left">符号</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>abs(x)</strong></td>
<td align="left">求绝对值1、参数可以是整型，也可以是复数2、若参数是复数，则返回复数的模</td>
</tr>
<tr>
<td align="left">complex([real[, imag]])</td>
<td align="left">创建一个复数</td>
</tr>
<tr>
<td align="left">divmod(a, b)</td>
<td align="left">分别取商和余数注意：整型、浮点型都可以</td>
</tr>
<tr>
<td align="left"><strong>float([x])</strong></td>
<td align="left">将一个字符串或数转换为浮点数。如果无参数将返回0.0</td>
</tr>
<tr>
<td align="left"><strong>int([x[, base]])</strong></td>
<td align="left">将一个字符转换为int类型，base表示进制</td>
</tr>
<tr>
<td align="left">long([x[, base]])</td>
<td align="left">将一个字符转换为long类型</td>
</tr>
<tr>
<td align="left">pow(x, y[, z])</td>
<td align="left">返回x的y次幂</td>
</tr>
<tr>
<td align="left"><strong>range([start], stop[, step])</strong></td>
<td align="left">产生一个序列，默认从0开始</td>
</tr>
<tr>
<td align="left">round(x[, n])</td>
<td align="left">四舍五入</td>
</tr>
<tr>
<td align="left"><strong>sum(iterable[, start])</strong></td>
<td align="left">对集合求和</td>
</tr>
<tr>
<td align="left">oct(x)</td>
<td align="left">将一个数字转化为8进制</td>
</tr>
<tr>
<td align="left">hex(x)</td>
<td align="left">将整数x转换为16进制字符串</td>
</tr>
<tr>
<td align="left"><strong>chr(i) / asc(i)</strong></td>
<td align="left">返回整数i对应的ASCII字符 / ASCII字符对应的整数i</td>
</tr>
<tr>
<td align="left">bin(x)</td>
<td align="left">将整数x转换为二进制字符串</td>
</tr>
<tr>
<td align="left">bool([x])</td>
<td align="left">将x转换为Boolean类型</td>
</tr>
</tbody></table>
<h2 id="二、集合类操作"><a href="#二、集合类操作" class="headerlink" title="二、集合类操作"></a>二、集合类操作</h2><table>
<thead>
<tr>
<th align="left">符号</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">basestring()</td>
<td align="left">str和unicode的超类不能直接调用，可以用作isinstance判断</td>
</tr>
<tr>
<td align="left">format(value [, format_spec])</td>
<td align="left">格式化输出字符串格式化的参数顺序从0开始，如“I am {0},I like {1}”</td>
</tr>
<tr>
<td align="left">unichr(i)</td>
<td align="left">返回给定int类型的unicode</td>
</tr>
<tr>
<td align="left">enumerate(sequence [, start = 0])</td>
<td align="left">返回一个可枚举的对象,该对象的next()方法将返回一个tuple</td>
</tr>
<tr>
<td align="left">iter(o[, sentinel])</td>
<td align="left">生成一个对象的迭代器，第二个参数表示分隔符</td>
</tr>
<tr>
<td align="left"><strong>max(iterable[, args…][key])</strong></td>
<td align="left">返回集合中的最大值</td>
</tr>
<tr>
<td align="left"><strong>min(iterable[, args…][key])</strong></td>
<td align="left">返回集合中的最小值</td>
</tr>
<tr>
<td align="left"><strong>dict([arg])</strong></td>
<td align="left">创建数据字典</td>
</tr>
<tr>
<td align="left"><strong>list([iterable])</strong></td>
<td align="left">将一个集合类转换为另外一个集合类</td>
</tr>
<tr>
<td align="left">set()</td>
<td align="left">set对象实例化</td>
</tr>
<tr>
<td align="left">frozenset([iterable])</td>
<td align="left">产生一个不可变的set</td>
</tr>
<tr>
<td align="left"><strong>str([object])</strong></td>
<td align="left">转换为string类型</td>
</tr>
<tr>
<td align="left">sorted(iterable[, cmp[, key[, reverse]]])</td>
<td align="left">队集合排序</td>
</tr>
<tr>
<td align="left">tuple([iterable])</td>
<td align="left">生成一个tuple类型</td>
</tr>
<tr>
<td align="left">xrange([start], stop[, step])</td>
<td align="left">xrange()函数与range()类似，但xrnage()并不创建列表，而是返回一个xrange对象，它的行为与列表相似，但是只在需要时才计算列表值，当列表很大时，这个特性能为我们节省内存</td>
</tr>
</tbody></table>
<h2 id="三、逻辑判断"><a href="#三、逻辑判断" class="headerlink" title="三、逻辑判断"></a>三、逻辑判断</h2><table>
<thead>
<tr>
<th align="left">符号</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">all(iterable)</td>
<td align="left">1、集合中的元素都为真的时候为真2、特别的，若为空串返回为True</td>
</tr>
<tr>
<td align="left">any(iterable)</td>
<td align="left">1、集合中的元素有一个为真的时候为真2、特别的，若为空串返回为False</td>
</tr>
<tr>
<td align="left">cmp(x, y)</td>
<td align="left">如果x &lt; y ,返回负数；x == y, 返回0；x &gt; y,返回正数</td>
</tr>
</tbody></table>
<h2 id="四、反射"><a href="#四、反射" class="headerlink" title="四、反射"></a>四、反射</h2><table>
<thead>
<tr>
<th align="left">符号</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">callable(object)</td>
<td align="left">检查对象object是否可调用1、类是可以被调用的2、实例是不可以被调用的，除非类中声明了<strong>call</strong>方法</td>
</tr>
<tr>
<td align="left">classmethod()</td>
<td align="left">1、注解，用来说明这个方式是个类方法2、类方法即可被类调用，也可以被实例调用3、类方法类似于Java中的static方法4、类方法中不需要有self参数</td>
</tr>
<tr>
<td align="left">compile(source, filename,  mode[, flags[, dont_inherit]])</td>
<td align="left">将source编译为代码或者AST对象。代码对象能够通过exec语句来执行或者eval()进行求值。1、参数source：字符串或者AST（Abstract Syntax Trees）对象。2、参数 filename：代码文件名称，如果不是从文件读取代码则传递一些可辨认的值。3、参数model：指定编译代码的种类。可以指定为 ‘exec’,’eval’,’single’。4、参数flag和dont_inherit：这两个参数暂不介绍</td>
</tr>
<tr>
<td align="left">dir([object])</td>
<td align="left">1、不带参数时，返回当前范围内的变量、方法和定义的类型列表；2、带参数时，返回参数的属性、方法列表。3、如果参数包含方法<strong>dir</strong>()，该方法将被调用。当参数为实例时。4、如果参数不包含<strong>dir</strong>()，该方法将最大限度地收集参数信息</td>
</tr>
<tr>
<td align="left">delattr(object, name)</td>
<td align="left">删除object对象名为name的属性</td>
</tr>
<tr>
<td align="left">eval(expression [, globals [, locals]])</td>
<td align="left">计算表达式expression的值</td>
</tr>
<tr>
<td align="left">execfile(filename [, globals [, locals]])</td>
<td align="left">用法类似exec()，不同的是execfile的参数filename为文件名，而exec的参数为字符串。</td>
</tr>
<tr>
<td align="left">filter(function, iterable)</td>
<td align="left">构造一个序列，等价于[ item for item in iterable if function(item)]1、参数function：返回值为True或False的函数，可以为None2、参数iterable：序列或可迭代对象</td>
</tr>
<tr>
<td align="left">getattr(object, name [, defalut])</td>
<td align="left">获取一个类的属性</td>
</tr>
<tr>
<td align="left">globals()</td>
<td align="left">返回一个描述当前全局符号表的字典</td>
</tr>
<tr>
<td align="left">hasattr(object, name)</td>
<td align="left">判断对象object是否包含名为name的特性</td>
</tr>
<tr>
<td align="left">hash(object)</td>
<td align="left">如果对象object为哈希表类型，返回对象object的哈希值</td>
</tr>
<tr>
<td align="left">id(object)</td>
<td align="left">返回对象的唯一标识</td>
</tr>
<tr>
<td align="left">isinstance(object, classinfo)</td>
<td align="left">判断object是否是class的实例</td>
</tr>
<tr>
<td align="left">issubclass(class, classinfo)</td>
<td align="left">判断是否是子类</td>
</tr>
<tr>
<td align="left"><strong>len(s)</strong></td>
<td align="left">返回集合长度</td>
</tr>
<tr>
<td align="left">locals()</td>
<td align="left">返回当前的变量列表</td>
</tr>
<tr>
<td align="left">map(function, iterable, …)</td>
<td align="left">遍历每个元素，执行function操作</td>
</tr>
<tr>
<td align="left">memoryview(obj)</td>
<td align="left">返回一个内存镜像类型的对象</td>
</tr>
<tr>
<td align="left">next(iterator[, default])</td>
<td align="left">类似于iterator.next()</td>
</tr>
<tr>
<td align="left">object()</td>
<td align="left">基类</td>
</tr>
<tr>
<td align="left">property([fget[, fset[, fdel[, doc]]]])</td>
<td align="left">属性访问的包装类，设置后可以通过c.x=value等来访问setter和getter</td>
</tr>
<tr>
<td align="left">reduce(function, iterable[, initializer])</td>
<td align="left">合并操作，从第一个开始是前两个参数，然后是前两个的结果与第三个合并进行处理，以此类推</td>
</tr>
<tr>
<td align="left">reload(module)</td>
<td align="left">重新加载模块</td>
</tr>
<tr>
<td align="left">setattr(object, name, value)</td>
<td align="left">设置属性值</td>
</tr>
<tr>
<td align="left">repr(object)</td>
<td align="left">将一个对象变幻为可打印的格式</td>
</tr>
<tr>
<td align="left">slice（）</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">staticmethod</td>
<td align="left">声明静态方法，是个注解</td>
</tr>
<tr>
<td align="left">super(type[, object-or-type])</td>
<td align="left">引用父类</td>
</tr>
<tr>
<td align="left"><strong>type(object)</strong></td>
<td align="left">返回该object的类型</td>
</tr>
<tr>
<td align="left">vars([object])</td>
<td align="left">返回对象的变量，若无参数与dict()方法类似</td>
</tr>
<tr>
<td align="left">bytearray([source [, encoding [, errors]]])</td>
<td align="left">返回一个byte数组1、如果source为整数，则返回一个长度为source的初始化数组；2、如果source为字符串，则按照指定的encoding将字符串转换为字节序列；3、如果source为可迭代类型，则元素必须为[0 ,255]中的整数；4、如果source为与buffer接口一致的对象，则此对象也可以被用于初始化bytearray.</td>
</tr>
<tr>
<td align="left">zip([iterable, …])</td>
<td align="left">实在是没有看懂，只是看到了矩阵的变幻方面</td>
</tr>
</tbody></table>
<h2 id="五、IO操作"><a href="#五、IO操作" class="headerlink" title="五、IO操作"></a>五、IO操作</h2><table>
<thead>
<tr>
<th align="left">符号</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">file(filename [, mode [, bufsize]])</td>
<td align="left">file类型的构造函数，作用为打开一个文件，如果文件不存在且mode为写或追加时，文件将被创建。添加‘b’到mode参数中，将对文件以二进制形式操作。添加‘+’到mode参数中，将允许对文件同时进行读写操作1、参数filename：文件名称。2、参数mode：’r’（读）、’w’（写）、’a’（追加）。3、参数bufsize：如果为0表示不进行缓冲，如果为1表示进行行缓冲，如果是一个大于1的数表示缓冲区的大小 。</td>
</tr>
<tr>
<td align="left"><strong>input([prompt])</strong></td>
<td align="left">获取用户输入推荐使用raw_input，因为该函数将不会捕获用户的错误输入</td>
</tr>
<tr>
<td align="left"><strong>open(name[, mode[, buffering]])</strong></td>
<td align="left">打开文件与file有什么不同？推荐使用open</td>
</tr>
<tr>
<td align="left"><strong>print</strong></td>
<td align="left">打印函数</td>
</tr>
<tr>
<td align="left">raw_input([prompt])</td>
<td align="left">设置输入，输入都是作为字符串处理</td>
</tr>
</tbody></table>
<h2 id="六、其他"><a href="#六、其他" class="headerlink" title="六、其他"></a>六、其他</h2><p><strong>help()–帮助信息</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/03/Python-%E5%AD%A6%E4%B9%A01/" data-id="ckbw9eipw000534ur4hd53r3t" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">-python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-有关海华AI比赛thought" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/18/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9Bthought/" class="article-date">
  <time datetime="2020-04-18T01:33:50.000Z" itemprop="datePublished">2020-04-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/04/18/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9Bthought/">有关海华AI比赛thought</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="海华AI比赛感受-Haihua-AI-garbage-classification-competition"><a href="#海华AI比赛感受-Haihua-AI-garbage-classification-competition" class="headerlink" title="海华AI比赛感受 Haihua AI garbage classification competition"></a>海华AI比赛感受 Haihua AI garbage classification competition</h1><p>看到垃圾分类这个标题时我就决定要参加这个比赛。我之前也参加过类似的项目课题研究，只是并不专业，更注重社科题材的研究。那时我请教老师，老师说用机器学习构建神经网络然后图像识别进行垃圾分类其实是个很简单的事情。于是我变很好奇到底是怎么做到的。</p>
<p>What was it? I decided to take part in Haihua Al rubbish classification competition when I saw the title ‘rubbish classification’, which is to use computer classify the rubbish. After all, computer science is the major I have chosen. At that time, I asked my teacher for some advice, and he said that it was actually just using the machine learning to build neural networks and then use image recognition to classify garbage. Then, I truly became curious about how it could be done.</p>
<p>参加比赛前，我们进行了学习。老师从如何预测简单的商店营业额一直教到图像处理，看似无关的知识点之间环环相扣，最终实现了创建模型，识别图片并垃圾分类。刚学完时，我都不敢相信课程已经结束了，原来创建模型真的不是一件难事。安装配备tensorflow等包（也可以尝试其他环境），导入数据和图片，用图片信息进行编号，分成训练集和测试集，合理运用Keras官网上准确度较高的模型，训练自己的模型，最终运行模型获得预测数据，整过程便结束了。</p>
<p>My group learnt some relevant knowledge before we took part in the competition, being taught from how to predict the turnover of a store by plotting graph to how to do image processing, from simple to difficult. Seemingly irrelevant knowledge points were interlinked, such as which PS skills can be realized by using the image processing codes, and finally the model, which was suitable for the competition, was created and images were recognized and rubbish classification was realized. When I finished, I couldn’t believe the course was over, because there were too many things for me to learn that the time really flew. It turned out that it wasn’t so hard to create models. Installing packages such as tensorflow (you can also try other environments), importing data and pictures, numbering them with picture information …… and finally running the model to obtain the prediction data, the whole process is over.</p>
<p>别看只写了两三行字，这中间可是用了几周的时间，训练模型确实是件苦差事。从开始二三十遍为一循环，到十次一循环，到最后一次一循环，准确度始终在99.7徘徊，却始终没有更好的成绩，确实是一件令人着急的事。还有上学的缘故，家里电脑硬件不足，我还学会了远程操控电脑。其中还有不少困难：电脑硬件出现问题，电脑无法连接，硬盘内存满了要换一个盘，环境未匹配上，下载官网模型时间过长通过其他办法下载……虽然有困难，但我们都一一解决了。这也有助于我对这一块知识的了解，比如在学习编程之前，我可以说是对电脑一无所知，只会上网。而现在，不论是编程语言的更加熟练，还是对电脑的更加熟悉，都有助于我将来的学习，毕竟这是我选定的专业方向。当然，经历了这么多，我也逐渐能做到做事时能不像以前那么着急，不能图快，一件一件慢慢处理才能达到最高的效率。</p>
<p>Despite writing only two or three lines of codes, it took weeks to train the model. From the beginning with 20 or 30 times for a cycle of training, to 10 times a cycle, to at last once a cycle, the accuracy was always hovering in 99.7 percent. But that there is no more better accuracy is really a matter of urgency. Also because of school schedule and the insufficient home computer hardware, I also learned to operate the computer remotely, which can save my time on the way. Meanwhile, there were also many difficulties, such as computer hardware problems, Internet connection difficulties, the hard disk memory is full, the environment is not matched, and so on. Although there were difficulties, we solved them one by one which added to my deeper understanding of the programme. For instance, before learning programming, I can say that I knew nothing about computers, except the Internet. Now,being more proficient in the programming language and more familiar with the computer can absolutely help me in my future studies. By taking part in this competition I learn a lot of important skills such as time management and working in a methodical and reflective way.</p>
<p>曾经，我觉得这是一个多么遥远的专业，因为不了解，所以觉得简直是不可能的事情。但如今回头再看，其实没有我想的那么难。学习就是这样，是一个上升的阶梯，从下往上看时感觉遥不可及，但当不知不觉爬上去后往下看，似乎也没那么遥远。</p>
<p>In the past, I thought learning this programme would be beyond my capabilities because I was not familiar with it and it felt impossible for me to understand. However, looking back now, it was not as hard as I thought. Learning is just like this, a ladder: when I get from the bottom to the top, I feel it far away; when unwittingly climbing up and looking down, it seems not so far away.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/04/18/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9Bthought/" data-id="ckbw9eiqo001m34ur410n599o" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-其他翻译-Other-Translation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/08/%E5%85%B6%E4%BB%96%E7%BF%BB%E8%AF%91-Other-Translation/" class="article-date">
  <time datetime="2020-04-08T06:53:59.000Z" itemprop="datePublished">2020-04-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/04/08/%E5%85%B6%E4%BB%96%E7%BF%BB%E8%AF%91-Other-Translation/">其他翻译 Other Translation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong><code>All the pictures are designed and made by Arya(myself).</code></strong></p>
<p><strong><code>All the sentences are translated by me, too.</code></strong></p>
<p><strong><code>If you want to send to other places, please let me know and issue with my name.</code></strong></p>
<p><strong>图文借由本人亲自制作，如转载请告知并发布时署我的名。</strong></p>
<p>我的lofter主页（my lofter homepage）：<a href="https://ganlezheipingjiajiu.lofter.com/" target="_blank" rel="noopener">https://ganlezheipingjiajiu.lofter.com/</a></p>
<p>除p大句子外的一些翻译</p>
<p>This passage collect other translation written not by <strong>priest</strong>.</p>
<h2 id="OTHER-TRANSLATION"><a href="#OTHER-TRANSLATION" class="headerlink" title="OTHER TRANSLATION"></a>OTHER TRANSLATION</h2><p>from some writers in <strong>Lofter</strong></p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNERZRURDZ1pwakVMdkF3MDJGOG1tYTl5QWFaVkdNU215NDBwL2FnMElEVXNRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>“他们谁先动心的？”</p>
<p>“我先动心的。”</p>
<p>——姬野吉</p>
<p>“Which of them was first tempted?”</p>
<p>“I was tempted first.”</p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNERZRURDZ1pwakVMZzc5RDJjNjhhaGdsVHRWRGpQVGZMa3pMaWJOeC9hT25RPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>两个羁绊不深的人，在你的故事了纠缠了生生世世。</p>
<p>——Julien</p>
<p>Two people without deep fetter, in your story, entangle for life and death.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNERZRURDZ1pwakVMcWkxR1lySVVqeHZkYU5jNCtrcEpNYjdkYlN0YkR2Lyt3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>从前你只能意难平，此后你可以带着他们去看山河湖海，历经世间百态，到头来依然相爱。</p>
<p>——倚星辰</p>
<p>Once upon a time your mind can not be reconciled. After, you can take them to see the mountains, rivers, lakes and sea, experienced everything in the world, they still love each other in the end.</p>
<h2 id="A-song-written-for-the-book-by-priest《默读》"><a href="#A-song-written-for-the-book-by-priest《默读》" class="headerlink" title="A song written for the book by priest《默读》"></a>A song written for the book by <strong>priest</strong>《默读》</h2><p>The song called “Yi’mo”</p>
<p>《以沫》</p>
<p><img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFicW5HbjZXWE1FV2hQVXVSZXhsLzdHeWVtWG9NUXFQN0ZmL1FpSFNIUTN3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img">  </p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFicW5HbjZXWE1FZlFpN3N2eXpESkdZZEpLc0UvbjF2S3ZJcUI1U3h4VmFBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p><img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFicW5HbjZXWE1FZEFmaFhPVStwTTNOQStaT3RvVzh1T3BvcjgwUmhXRXlBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img">   </p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEFicW5HbjZXWE1FVkJaZGI4UDM3VVdDWnJSMjQxdzVYWE9lTFlEVlJFTkdnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"></p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFicW5HbjZXWE1FYkZKZWlUT1kxVGMycnhKczNJL1VLN0tNanJ1RlNHbzFnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEFicW5HbjZXWE1FWDlwQTM1bzkxVzZhV3ZMVXNQVHBoSEdSbUZSNE1Cemx3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEFicW5HbjZXWE1FWlpYdGVMUkZxNWRZM3c1azNtZGFqRThKMUlwa3dUL0h3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>我心里有一簇迎着烈日而生的花</p>
<p>In my heart, there is a cluster of flowers facing the sun, </p>
<p>比一切美酒都要芬芳</p>
<p>more fragrant than all the wine,</p>
<p>滚烫的馨香淹没过稻草人的胸膛</p>
<p>the fragrance overflows the scarecrow’s chest, </p>
<p>草扎的精神</p>
<p>the spirit of the grass, </p>
<p>从此万寿无疆</p>
<p>from now on, forever.</p>
<p>朝夕如昨 你眼中飞蛾扑火</p>
<p>Day is like yesterday, moths to a flame in your eyes</p>
<p>为何选择 沉默</p>
<p>Why you choose to be silent? </p>
<p>多年又过 是谁轻声诵读着</p>
<p>Years passed by, who is chanting softly</p>
<p>生死 同爱恨 分隔</p>
<p>life and death, just like love and hate, are separated</p>
<p>地狱之门大开着 眼前愈发浑浊</p>
<p>The door of hell is open, the views in front becoming more and more muddy</p>
<p>默念恶魔的名册</p>
<p>Reading the register of demon</p>
<p>奄奄一息是我</p>
<p>I’m dying</p>
<p>猝然消逝的流星 一闪划过</p>
<p>The evanescent meteor shooting across</p>
<p>明明不舍</p>
<p>obviously unwilling</p>
<p>掐灭了烟火</p>
<p>snuffing off the fireworks</p>
<p>黑色 描摹轮廓</p>
<p>Darkness depicts the outline</p>
<p>我一人漂浪 岩浆滚烫漫过胸膛</p>
<p>I wander alone, scalding lava overflowing my chest </p>
<p>心底的芬芳 向烈日生长</p>
<p>Fragrance inside my heart grow towards the sun</p>
<p>你去那远方 没有黎明不见曙光</p>
<p>The remote place you go has no light of dawn</p>
<p>也无悔 深渊 同往</p>
<p>I won’t regret to go to abyss with you</p>
<p>单曲循环一首歌 过往深深烙刻</p>
<p>Single cycle a song, past deeply engraved</p>
<p>光阴在无度挥霍 分清善恶始末</p>
<p>Time is wasted inordinately, distinguishing the good and evil, beginning and end</p>
<p>这人间万家灯火 值不值得</p>
<p>Wether the world of lights is worthy of</p>
<p>靠岸停泊</p>
<p>Letting me dock the berth</p>
<p>迷雾中湮没</p>
<p>Losing in the mist</p>
<p>光影 悄悄褪色</p>
<p>Shadow is fading quietly</p>
<p>我一人漂浪 岩浆滚烫漫过胸膛</p>
<p>I wander alone, scalding lava overflowing my chest </p>
<p>心底的芬芳 向烈日生长</p>
<p>Fragrant things inside my heart grow towards the sun</p>
<p>你去那远方 没有黎明不见曙光</p>
<p>The remote place you go has no light of dawn</p>
<p>也无悔 深渊 同往</p>
<p>I won’t regret to go to abyss with you</p>
<p>船泊岸的港</p>
<p>The port that ships berth</p>
<p>一束微光照进了窗</p>
<p>A beam of light shine through window</p>
<p>我在你身旁 愈合了心伤</p>
<p>I’m here for you, with inner healing</p>
<p>击碎的波浪</p>
<p>The broken waves</p>
<p>此消彼长见证过往</p>
<p>Shift and witness the past</p>
<p>同时光 万寿 无疆</p>
<p>At the same time, live forever</p>
<p>万年后</p>
<p>After ten thousand years</p>
<p>你和我</p>
<p>you and me</p>
<p>化作了</p>
<p>will change into</p>
<p>两朵泡沫</p>
<p>Two bubbles</p>
<p>重逢时 礁石上相濡以沫</p>
<p>When meeting again, on the reef, we live on each other</p>
<p>难舍</p>
<p>Hard to separate</p>
<p>你温柔那刻 茫茫人海化作粉末</p>
<p>Your gentleness at that moment, turns into powder in the crowd</p>
<p>自愈的沉疴 暗淡了血色</p>
<p>Self-healing rottenness and the dark blood</p>
<p>我未经允诺</p>
<p>Without your permission,</p>
<p>告别沙丘远离荒漠</p>
<p>I bid farewell to the dunes, left away from the desert</p>
<p>只为那 一瞬 星火</p>
<p>Only for that moment of spark</p>
<p>孤舟随烟波</p>
<p>Lonely boat floating with tide</p>
<p>渡我</p>
<p>Puts me across</p>
<h2 id="A-song-written-for-the-book-by-priest-《杀破狼》"><a href="#A-song-written-for-the-book-by-priest-《杀破狼》" class="headerlink" title="A song written for the book by priest 《杀破狼》"></a>A song written for the book by <strong>priest</strong> 《杀破狼》</h2><p>The song called “Yue’ruo’liu’jin”(means the moon is like flowing gold)</p>
<p>《月若流金》</p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNERucUZwaG0ySlRsdEVkUldGZENETGx5WE1nRW8vVzVTTWF1OHpkWUJOZllBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNERucUZwaG0ySlRsbGxhWDRHVnFtcU42VDJyS1F2Mk5vVE84dDIzV3E3bWlBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNERucUZwaG0ySlRsbFFURkxtK2xJSmx0K2dYcytZeVkxeG9CZVg3dTF1eUVnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNERucUZwaG0ySlRsdXZUdkIwV3VmbHNRbUR6VjVBYTRPME81MFJSRkpvTWZRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNERucUZwaG0ySlRscjZFMVdpYzVETzlhZDhRWHYxUkVxTm50UHZOdGNUa0VRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNERucUZwaG0ySlRsdmhEMElXNVpRY1BJSUFGQ20yWWtlVE82ZjAvalA5NW5nPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNERucUZwaG0ySlRsZ1A2K244dzc5YmhoN0NsVGtEZ1ZwZHVManh1bzJSeXNBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNERucUZwaG0ySlRsc0RMMHdwV2tueVBLQzNTZ1h4V1VhSXllVUhzRU45alNRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>笑身无长处</p>
<p>Laugh at myself for no merit</p>
<p>唯耳目通肝胆</p>
<p>Blind,deaf,still devoted</p>
<p>见锦簇花繁</p>
<p>Seen prosperous views</p>
<p>也见黄沙血染</p>
<p>Seen bloody battlefield</p>
<p>听锦瑟无端</p>
<p>Heard stringed and woodwind</p>
<p>还听破鼓擂桴断</p>
<p>Heard broken drum and stick</p>
<p>过声色 踏铁马 何惧不还</p>
<p>Experienced, combated, why fear in no back</p>
<p>恼负尽千策</p>
<p>All clever strategy</p>
<p>却七窍却通一环</p>
<p>Something wrong inside</p>
<p>有情出肺腑</p>
<p>Emotion from the heart</p>
<p>竟与风月无关</p>
<p>Irrelevant to romance</p>
<p>凭耳不能闻</p>
<p>Can not hear through ears</p>
<p>这眼尚也不曾看</p>
<p>Also can’t see through eyes</p>
<p>是愚人 是痴人 随人叹</p>
<p>A simpleton, the crazy, sigh along</p>
<p>一朝盛景总始于东风送暖</p>
<p>Flourishing age starts from east wind’s gift</p>
<p>升平之世终如花向晚</p>
<p>Heyday like withered flowers</p>
<p>月若流金 岁若长河 时光荏苒</p>
<p>Moon like flowing gold, time like currency, time flies</p>
<p>此时沧 彼时桑 天地皆平凡</p>
<p>Vicissitude here, and another, everything is ordinary</p>
<p>曾认这一腔承千帆</p>
<p>Once admitted, my heavy responsibility</p>
<p>衷肠无曲直 横骨自反</p>
<p>Loyalty has no true /false, duty or rebellion</p>
<p>借天三分胆 纵万夫敢一战</p>
<p>Borrow courage from the god, leading thousands for a fight</p>
<p>唯遇你 一念百转</p>
<p>When meeting you, mind keeps changing</p>
<p>顾此生 惟一心分两半</p>
<p>Viewing my life, divide mind into half</p>
<p>从此多反复 方知温软</p>
<p>From that time and again, know the warmth</p>
<p>一半赠河山 换万家得长安</p>
<p>One half for the land, wish all be peaceful</p>
<p>余一半 愿君好梦正酣</p>
<p>Remainder, wish you sweet dream</p>
<p>人生无长乐</p>
<p>Sweet can not last</p>
<p>便莫计较悲欢</p>
<p>Don’t haggle over</p>
<p>勿怨锦衣单</p>
<p>Don’t complain thin clothes</p>
<p>从未觉塞上寒</p>
<p>Never feeling the chill</p>
<p>至得你心念</p>
<p>Till your wishes fulfill</p>
<p>醍醐竟识了冷暖</p>
<p>Realizing warm and cold</p>
<p>或当断 终未断 惹心乱</p>
<p>Indecision, procrastination, disturbing the mind</p>
<p>未知苦处 怎信神佛懂尘寰</p>
<p>Experiencing no hardship, how to have the belief</p>
<p>不识情重 人生如一栈</p>
<p>Having no appreciation,life’s like a game</p>
<p>盛世将倾 深渊在侧 我辈来担</p>
<p>Heyday’s falling, cliff’s nearby, in charge of us</p>
<p>向此生 为之殁 万死皆无憾</p>
<p>All my life,fight for it, dying for no regreting</p>
<p>曾认这一腔承千帆</p>
<p>Once admitted, my heavy responsibility</p>
<p>衷肠无曲直 横骨自反</p>
<p>Loyalty has no true /false, duty or rebellion</p>
<p>借天三分胆 纵万夫敢一战</p>
<p>Borrow courage from the god, leading thousands for a fight</p>
<p>唯遇你 一念百转</p>
<p>When meeting you, mind keeps changing</p>
<p>愿一世 与君老生常谈</p>
<p>Wish whole life, always chat with you</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/04/08/%E5%85%B6%E4%BB%96%E7%BF%BB%E8%AF%91-Other-Translation/" data-id="ckbw9eiqg001134urcz5z2j4m" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/translation/" rel="tag">-translation</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-翻译Translation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/08/%E7%BF%BB%E8%AF%91Translation/" class="article-date">
  <time datetime="2020-04-08T05:43:53.000Z" itemprop="datePublished">2020-04-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/04/08/%E7%BF%BB%E8%AF%91Translation/">翻译Translation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Translation"><a href="#Translation" class="headerlink" title="Translation"></a>Translation</h1><p><strong><code>All the pictures are designed and made by Arya(myself).</code></strong></p>
<p><strong><code>All the sentences are translated by me, too.</code></strong></p>
<p><strong><code>If you want to send to other places, please let me know and issue with my name.</code></strong></p>
<p><strong>图文借由本人亲自制作，如转载请告知并发布时署我的名。</strong></p>
<p>我的lofter主页（my lofter homepage）：<a href="https://ganlezheipingjiajiu.lofter.com/" target="_blank" rel="noopener">https://ganlezheipingjiajiu.lofter.com/</a></p>
<p>本文专门翻译一些我喜欢的句子，来自我崇拜的一位作者<strong>priest</strong>。(按书分类)</p>
<p>This passage collects all my translation of the sentences from my favorite writer <strong>priest</strong>.(classified according to the books)</p>
<h2 id="1-《杀破狼》"><a href="#1-《杀破狼》" class="headerlink" title="1.《杀破狼》"></a>1.《杀破狼》</h2><img src="https://s1.ax1x.com/2020/04/08/GWFWDI.png" alt="GWFWDI.png" style="zoom: 33%;" />

<p>1）“我大将军，一言九鼎”“战无不胜”</p>
<p>“My general, keep the solemn promise” “Invincible”</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWer5t.png" alt="GWer5t.png"></p>
<p>2）经年痴心妄想，一朝走火入魔。</p>
<p>Years of wishful thinking, once gone.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWmoeH.png" alt="GWmoeH.png"></p>
<p>3）臣顾昀，救驾来迟了。</p>
<p>Liege Gu Yun，forgive me for the late secure.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWu7Gt.png" alt="GWu7Gt.png"></p>
<p>4）有人心易变，三头五年便面目全非；</p>
<p>也有人心如止水，十万八千里走过，初心不改。</p>
<p>Some people are fickle, </p>
<p>and in the first three or five years they have changed beyond recognition; </p>
<p>There are also people like calm water, thousands of miles through, remain true to the original aspiration.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWMOEQ.png" alt="GWMOEQ.png"></p>
<p>5）天理伦常在上，除此以外，要星星不给月亮，就算阴天下雨我也架个梯子上天给你摘，好不好?</p>
<p>In addition to the morality, you want the stars I do not give the moon, even if it is cloudy and rainy I also put up a ladder to heaven for you to pick, ok?</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GW1gBT.png" alt="GW1gBT.png"></p>
<p>6）附一掌送抵江北，替我丈量伊人衣带可曾宽否。</p>
<p>With a hand sending to Jiangbei, for me to measure whether your garment is wider.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFtVzhRSzZRNEY1eWE4VmdTN0xJMkNkZ2hvWnJLSG43RFRMS2dZYkRtbnFBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>7）何人知我霜雪催，何人与我共一醉。</p>
<p>Who can understand me, who will get drunk with me.</p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNEF0WHc5UVpaUENlNHVGSG1zdFRlNXhEbWkrRjVITGgwUW5xekRmVDl2SzNBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>8）每个人都会遇到自己生命中看似无法战胜的敌人，有些是灾难，有些只是磨砺——你知道磨砺和灾难的区别吗?区别就是，灾难是不可战胜的，而磨砺是可以越过的。</p>
<p>Everyone will meet their own seemingly invincible enemies in life, some of them are disasters, some of them are just grinding – do you know the difference between grinding and disaster? The difference is that while disaster is invincible, grit can be overcome.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEE3MCtiUSswczdMWTFIdkltV2ZqNnVQekR2L1VuMXJTZ1kyNHZTYTBPNVRRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>9）我到过一生归宿之地，生前身后再无遗憾，不必留什么血脉。</p>
<p>I have been to the place where I belong, and have no regrets in life or death. I don’t need a heir. </p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFtOE5tRElYdmJ4OVNXcDZteitPbGZBU1h1UElTcmJlS2lTdU05L0pIYlF3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>10）信不信在你，度不度在我。</p>
<p>Believing or not is your choice, releasing the soul or not is my choice.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNENZQ1lGTkh2eG1LdGR6bndzanhPcVlDeGJQcWNNVGl5Y0lwZ0JvQ3FtOXVnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>11)未知苦处，不信神佛。</p>
<p>Haven’t been suffering, not believing in god Buddha.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEIyK0ExWno0TVMvV09mZkRmc3ZpL2VWbjUxdkp5eTE4OUJtcElVOFl6M25BPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>12)“我封侯安定，就是为大梁打仗的”</p>
<p>I,Duke Anding, am born to fight for great Liang Dynasty. </p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNEI5QUpoTmJiMWFubjVZbDE4VDBodlJzT1haallGMDVseTUxOUcvTGl6MlZ3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>13）风雨飘摇中大厦将倾，然而只要那根磐石梁柱犹未倒、玄铁军威风骨未折，便总有将这破败河山收拾起来的一天。</p>
<p>In the midst of the storm, the building will tilt. However, as long as the rock beam column are still there, xuantie military’s bone is not broken, there will always be a day to recover this ruined territory.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEFXeDE5dGtqS0VRTERWV0RpL3Z3QWd2di9qUW1XOXAyWUdEZWIzNVpNaGRRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>14）你说，不管怎么样我都接受得了，只要我活着一天，他是疯是傻我都管到底。</p>
<p>Do say it. I can live with any result, as long as I live, whether he’s mad or stupid I will take care of him.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEF5S2thRjZ2d0RSMVJSLzZNWUEyaU5IMytqYmV5VmJMY0I5MGkwa0hMQUtRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>15）忽然间，他有种感觉，好像多灾多难、几聚几散的玄铁营始终垫在社稷之下，像一把散落的种子，流落四方，不知不觉中便能从哪里长出一棵参天大树。</p>
<p>All of a sudden, he had a feeling, as if the calamitous and on-off Xuantie camp has been buried under the land, like a scattered seeds, out of nowhere grew a towering tree silently.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNERVWk1qY0tMZ3d2aHcyZGw0UGwvczIyNXdUdmJLWE9ZenRBU3JFYVpLaE9BPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>16）“凭君莫话封侯事”“一片冰心在玉壶”（These two sentences both comes from Chinese ancient poems,but not the poem. It is just a joke to put them together in the book)</p>
<p>Please don’t mention any more about the appointment</p>
<p>My bright heart, like ice in a jade kettle, is crystal clear and flawless</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNENLYlJEQTFoWFo3Qk9BZnEyWVpvQVliMkxhNkx3MkpTTnNwRDN2TVZ4MG1BPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>17)烈火浮于海上，忠魂粉身碎骨。</p>
<p>The fire floating on the sea, and the loyal soul shattered. </p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNENrUy9Ba3hJT2hjdHN1Lzd1MzJXZ3VJS3dZYVZGVitWRnE1cTlZenRPcEp3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>18) 那目光专注级了，微微映着一点浅浅的雪光，好像要将他整个人装在眼里。</p>
<p>The eyes were concentrated, reflecting beams of light from snow, and it seemed to hold him in the eyes.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEN3ekdlYk85MUkvSlg4anRGeXFBTCsvcnpTaWIydWlWUW84NlVIQVJsRExnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>19) 要不是弥足深陷，怎么配算是走火入魔。</p>
<p>If he wasn’t so deep, how could he be so crazy. </p>
<h2 id="2-《镇魂》"><a href="#2-《镇魂》" class="headerlink" title="2.《镇魂》"></a>2.《镇魂》</h2><img src="https://s1.ax1x.com/2020/04/08/GWZU7n.png" alt="GWZU7n.png"  />

<p>1）镇生者之心，安亡者之魂。</p>
<p>Pacificate the heart of the living, pacify the soul of the dead.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWmByF.png" alt="GWmByF.png"></p>
<p>2）我连魂魄都是黑的，唯独心尖上一点点，血还是红的。用它护你我愿意。</p>
<p>My soul is black, only my heart is red. I’ll protect you with it.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWQCuT.png" alt="GWQCuT.png"></p>
<p>3）生不由己，不如不生。</p>
<p>Better not to be born than not to live as I wish.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWlJwF.png" alt="GWlJwF.png"></p>
<p>4）世界上有一种人，不是那种你怎么看怎么好，怎么闭月羞花，怎么非卿不可、就想从此君王不早朝了，而是你觉得，要是你对不起他，你自己简直就不是东西。</p>
<p>There is a kind of people in the world, not that you see how good, how pretty, how you must get,and the king doesn’t govern, but you feel, if you do wrong to him, you are absolutely not a person.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEF5S2thRjZ2d0RSMzdLR3MyVURpT2JhQXF0M3JSZzJvRU5kSXJUaUFkSWR3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>5）我富有天下名山大川，想起来也没什么稀奇的，不过就是一堆烂石头野河水，浑身上下，大概也就只有这几分真心能上秤卖上两斤，你要?拿去。</p>
<p>I own the world’s famous mountains and rivers, nothing unusual, they are just a pile of rotten stone and wild water, all over my body, probably only a few pieces of genuineness can be weighed and sold for two jin, do you want? Take it.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNERVWk1qY0tMZ3d2dmJ5NkJaVmp1Ym9TVnZuSHRwemRmbG5UdTRkdGNvc0xRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>6)九幽听令 以血为誓 以冷铁为证 借尔三千阴兵 天地人神 皆可杀 (It is an incantation in the book)</p>
<p>Hell, listen to the command, use blood as oath, use cold iron as evidence, borrow your three thousand soldiers, heaven, earth, god and people, all can be killed！</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNENLYlJEQTFoWFo3SDdodWhidzE2T0N2MDc3dEpDTUwraEFVcS9hTW5sVGxRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>7)人心存污，常忧思而多苦，固怒而生怨，尽可为不可为之事，唯不作恶三字，乃天下大善，可济世镇魂者，无他耳。</p>
<p>People’s heart is dirty, frequent worrying causes more bitter, anger causes resentment. Among all that can be done and can not be done, only no evil things three words, is the world’s great kindness. It can also save the world and appease the soul.</p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNEIvSy81RjVRcmw3cEZ5UGU0QndRT0xTNEVoZzNQOTgrd1BPOVIxbHQvV2tRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>8) 他并不知道对方用的是哪一款，哪一种香，第一次闻见，那味道却仿佛已经叫他魂牵梦萦了很多年。</p>
<p>He did not know which kind of fragrance the other one was using, which kind of incense. When the first time smelling, the taste seems to have made him miss for many years.</p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNENrUy9Ba3hJT2hjcWJicXk2Zng5TC93dzRPM1NwbUREbjBTSkNONGgxamJ3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>9) 谎言就是谎言，草率地背上，就一辈子也卸不下来。</p>
<p>A lie is a lie, if carelessly carrying, and you will never be unloaded.</p>
<h2 id="3-《六爻》"><a href="#3-《六爻》" class="headerlink" title="3.《六爻》"></a>3.《六爻》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GWeiHs.png" alt="GWeiHs.png"></p>
<p>1）仿佛甜只有一瞬间，苦却苦了很多年</p>
<p>As if the sweet only lasted for a moment, but bitter for years</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWmv6S.png" alt="GWmv6S.png"></p>
<p>2）千丈深渊，未及心上一捧桃花潭。</p>
<p>Extreme abyss ，not to the treasure in my mind.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWQ85d.png" alt="GWQ85d.png"></p>
<p>3）除了顶天立地，唐真人真的一无是处了。</p>
<p>In addition to indomitable, Tang is really good for nothing.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GW3vZT.png" alt="GW3vZT.png"></p>
<p>4）千丈深渊，未及心上一捧桃花潭。</p>
<p>Extreme abyss ，not to the treature in my mind.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEFtVzhRSzZRNEY1MVB5SjZUeCszYUk1b3FOWVh3MDhsWG9ydW9HSU5hQTVBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>5）外有天大地大，我独身陷囹圄。</p>
<p>There is a big world outside, while I’m in jail alone.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEF0WHc5UVpaUENlK0ViMU1ETWErU3o1RWRpVjQ4VXkxbENEU1VXRndTbkhnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>6）这样浮光掠影地想一想，便觉千头万绪，摸不着头脑，未曾怦然，便已经心动。</p>
<p>Thinking about it in a superficial way, he felt like having a thousand thoughts, hard to fathom. He found that he hadn’t experienced heartfelt moment, he has already moved.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEE3MCtiUSswczdMWnErMlB1UERHWW52K0g0NEdGUVA0anN4SG0zekZlS01nPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>7）哪里有七情六欲，哪里就有水深火热。</p>
<p>Where there are the appentency and the lust, there is the great misery. </p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNENZQ1lGTkh2eG1LanMveDdWT2I1N2J2b0t2bVNaSnYzZFErcC8vQ0ZtNzhnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>8)天道无常，机关怎能由得人算尽?</p>
<p>Natural law is impermanent, how can it be predicted by people?</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEIyK0ExWno0TVMvUWtUVHludWNVbitIdm5WeU43OWZOeHYwcnE2cUNULzdBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>9)我不知道怎么待你才算好，但无论如何，绝不负你。</p>
<p>I don’t know how to be nice to you, but I’ll live up to you no matter what happens.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEI5QUpoTmJiMWFuc21hWFNoMG9QbDN2SC8yWGkxVDJ1NVZibGY3eVV4NGxRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>10)仲夏夜里蝉声四起，越发显得四下安宁，唯有夜空上一把银河如练，掬一捧光华万点，皎皎万岁春秋。寒来暑往，枯荣明灭。</p>
<p>In midsummer night, cicadas sound everywhere, it appears more and more peaceful. Only the Milky Way on the night sky looks like white silk, holding light with million points and the bright long living spring and autumn. As the winter and summer go, they thrive and die. </p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFXeDE5dGtqS0VRQXdxZ1QwRXFxclQvZlVqL1UxMjZWVnJuK2RDQkZUV3R3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEFXeDE5dGtqS0VRSW50QUxzUGtvKzZWcGlheGowaTl5dmNjcFRCbU94NFN3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>11）可惜程潜没长那根风流骨，他左手抱着满腔的真情实意，右手举着纸上谈兵的风花雪月，中间戳成了一根顶天立地的木头桩子。</p>
<p>Unfortunately, Cheng qian did not have that romantic character, holding the full of true feelings in his left hand, holding the illusion of romance in his right hand; in the middle, a wooden stick is there.</p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNEF5S2thRjZ2d0RSeklqQ3RwZjV4eE5LVDNlMmdSZmJaSjMzN0hsYXVUTHNnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>12）只要不瞎，谁站在远处都看得见绵绵河山壮阔，可是身在山中，谁又能在云雾深处找到自己身在何方?</p>
<p>As long as not blind, everyone can see the continuous magnificent rivers and mountains from distance. But when in the mountains, who can find himself in the depths of the clouds?</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEIvSy81RjVRcmw3dGcyQi9YK09adWl1OXVNelhkbUJlckwvbWlENlJYK1NnPT0.null?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>12) 程潜从不曾苛责他这个掌门师兄任何事，他的态度从一而终——你行你就上，你不行我粉身碎骨也替你上。</p>
<p>Cheng qian never criticized his senior for anything, his attitude from one to the last - if you can, you do; If you can’t, I’ll do it for you, despite smashing up.</p>
<h2 id="4-《山河表里》"><a href="#4-《山河表里》" class="headerlink" title="4.《山河表里》"></a>4.《山河表里》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GWe1ER.png" alt="GWe1ER.png"></p>
<p>1）火光冲天，他披着一身血淋淋的皮肉，六根不净。</p>
<p>Fire blazing, he was covered with bloody flesh, full of annoyance.</p>
<h2 id="5-《残次品》"><a href="#5-《残次品》" class="headerlink" title="5.《残次品》"></a>5.《残次品》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GWeTP0.png" alt="GWeTP0.png"></p>
<p>1）人们起源于信仰，毁于信仰，人们在信仰的灰烬里重生。</p>
<p>People are born from faith, destroyed by faith, and reborn from the ashes of faith.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWmPxO.png" alt="GWmPxO.png"></p>
<p>2）晨光起于白塔尖顶，终将铺满阴霾之地。</p>
<p>The morning light rises from the spire of the white tower, and will eventually cover the land of shadows.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWn590.png" alt="GWn590.png"></p>
<p>3）</p>
<p>假如我们在宇宙中粉身碎骨</p>
<p>残骸将漂泊于永夜</p>
<p>有朝一日在碰撞中湮灭</p>
<p>成为星星的一部分</p>
<p>而灵魂将重回故里</p>
<p>回到你出发的地方</p>
<p>你誓死守卫的地方</p>
<p>——自由宣言万岁！</p>
<p>Suppose we were blown to pieces in the universe</p>
<p>The wreckage will drift through the night</p>
<p>One day annihilate in a collision</p>
<p>Become part of the stars</p>
<p>And the soul will return home</p>
<p>Go back to where you started</p>
<p>The place you’ve sworn to defend</p>
<p>Long live the declaration of freedom!</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWQvZD.png" alt="GWQvZD.png"></p>
<p>4）因为铁石心肠，所以无坚不摧。</p>
<p>Nothing can break the heart of stone.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWlywD.png" alt="GWlywD.png"></p>
<p>5）</p>
<p>我带着深藏骨血的仇恨与酝酿多年的阴谋</p>
<p>把自己变成一个死而复生的幽灵</p>
<p>沉入沼泽，沉入深渊</p>
<p>我想埋下腐烂的根系</p>
<p>长出见血封喉的荆棘</p>
<p>刺穿这个虚伪的文明</p>
<p>我到了淤泥深处……</p>
<p>捡到了一颗星星。</p>
<p>I have a deep hatred and a plot that has been brewing for years</p>
<p>Turn myself into a ghost from the death</p>
<p>Sinking into the swamp, sinking into the abyss</p>
<p>I want to bury the rotten roots</p>
<p>and brambles with blood in their throats</p>
<p>Pierce this false civilization</p>
<p>I went deep into the mud…</p>
<p>Picked up a star.</p>
<p><strong>（Someone said it was better to use ‘In the bottom of the muck,I found my lucida. ‘ in the last sentence)</strong></p>
<p><img src="https://s1.ax1x.com/2020/04/08/GW3CKP.png" alt="GW3CKP.png"></p>
<p>6）头顶星空的人，即使趋利，也趋得有底线，而梦想和尊严是不能用钱践踏的。</p>
<p>穷途末路的梦想和尊严也是。</p>
<p>The person who sustains starry sky, despite hastening profit, it has a bottom line, while the dream and dignity cannot be trampled by money.</p>
<p>So do dead-end dreams and dignity.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEFtVzhRSzZRNEY1MVdRRVZGTTRNcS9oN09mK0N4Sk9kY1J2L3RoVGEvQVRRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>7）不是每一次出走，都还能再回去的。</p>
<p>Not every time you run away, you can go back.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEF0WHc5UVpaUENlL1dmM0FWT1RLR3pZeTAzR0k5c3VBZVliMDNkSWJ3R093PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>8）人的一生本来就是一场有来无回的冒险。</p>
<p>Life is an adventure with no return.</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEE3MCtiUSswczdMVVhnTDk0dkdhQ28rbjA4T2NrKzA1cWpUTjhSUUh6V0lRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>9）“比金钱更珍贵是知识，比知识更珍贵的是无休止的好奇心，而比好奇心更珍贵的，是我们头上的星空。”</p>
<p>“The one that is more precious than money is knowledge. The one that is more precious than knowledge is endless curiosity. And the one that is more precious than curiosity is the starry sky above us.”</p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNENZQ1lGTkh2eG1Lb1p4R2ZlSzZTekprR1NyTm8wMy8yYzF0enBTQjZNUGVnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>10)自由联盟军之歌：(a song)</p>
<p>我们来自海角，封闭沉默的群山，</p>
<p>We come from the promontory, from the silent hills,</p>
<p>在星光抛弃的荒原，点起呼唤自由的烽烟。</p>
<p>In the wasteland abandoned by the starlight, we ligh the beacon smoke to call for freedom.</p>
<p>听见狂风在咆哮，血在烧——</p>
<p>Hearing the wind roar and the blood burn</p>
<p>脚步在跃迁，旗在倒——</p>
<p>The feet are leaping, the flag is falling</p>
<p>啊，朋友，跟我们走吧，脱下镣铐，扬起风帆。</p>
<p>Oh friend, come with us, cast off your irons, and set sail.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEIyK0ExWno0TVMvZFRkMzM0UWJVblZJVnRMY0pucTlMRHNKSFczaGpua2lRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>11)坏事总会发生——墨菲定律。既然风浪总会来临，与其做听天由命的沙堡，不如亲自站在风口浪尖上。</p>
<p>Bad things always happen – Murphy’s law. Since the wind and waves will always come, it is better to stand on the top of the waves than to be a resigned sandcastle.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEI5QUpoTmJiMWFubG5jaXFXMVRlOW9LMHpPcE9VWXpBeWpSUHlsczBBNzBnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>12）每一段伟大的路上最初都布满荆棘，每一个先贤都曾被视为移山的愚公，古谚有云“只有通往地狱的路，才铺满善意的鲜花”，困境难道不是抵达梦想的必由之路吗？</p>
<p>Each section of the great road is at first full of thorns, each sage has been regarded as the “fool” who wants to move the mountain. As the old saying goes, “only the road to hell is paved with flowers of kindness.” Isn’t adversity the only way to reach your dreams?</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEFXeDE5dGtqS0VRQlpmN1cwNUYycHN5ODd4STdyODBYcXh0UkM4T3AzdFlRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>13）任何东西都有两面性，谁能让你幸福，谁就能让你迷失。</p>
<p>Everything has two sides, who can make you happy can make you lost.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEF5S2thRjZ2d0RSK01FenJXMkdaSTZLalFiVENHWDBOVDA0MVZBQldXNWl3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>14）你不能因为他们疯子多，声音大，就认为他们是正常的。</p>
<p>You can’t assume that crazy people are normal just because they’re crowded and loud.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNERVWk1qY0tMZ3d2azd5bCtBM2ZWSTQxU3VqMTdoUHFaSGNWWnpkODRZbEdnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>15)假如像古代神话里那样天降洪水，所有人都奔跑逃命，我愿意做那个逆着人潮而上，第一个被洪水淹没的人。</p>
<p>If, as in ancient mythology, there were a flood and everyone was running for their lives, I would be the first one to be drowned against the tide.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNENLYlJEQTFoWFo3Q1dmWTdFSVNBNm9HZklaM2s3d1pKekJJOXdDUW1SZDJnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>16）人一生中，总有那么一段日子，是每天盼望天亮的。</p>
<p>In life, there is always a period of time, that we look forward to the dawn every day.</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEIvSy81RjVRcmw3a1QzbVdadlgwVnczSEZSNEkzOHJxQTN0UlI2QWtqdlNRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>17) “喜欢一朵花，不见得非得看见花开，喜欢一个人，不见得非得有结果，追求爱与美的过程怎么能叫无用功呢？这本身就是一个非常美好的过程，你不觉得吗？”</p>
<p>“If you like a flower, you do not have to see its blossom. If you like a person, you do not have to have a result. How can the pursuit of love and beauty be called futile？It’s a beautiful process in itself, don’t you think so?”</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNENrUy9Ba3hJT2hjbDdsSnU3YWRDYjRnYVYrWGZsUzdEc0V5UUlmQW0vdTVBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>18) “我就是人性，”林静姝说，“什么是人性？人性就是饿了要吃，渴了要喝，别人对你好，记住他，回报他，别人践踏你，不惜一切也要报复回去——”</p>
<p>“I am human nature,” said Lin Jingshu. “what is human nature? Human nature is eating when you are hungry and drinking when you are thirsty. If people are good to you, remember them, pay back to them. If they trample on you, do anything to avenge–”</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEN3ekdlYk85MUkvQ1V3UStLUm5qRmx5enozUXVFeWVwdXpacXFBQVM0aFdBPT0.jpg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>19) 又或许，世界上每一个命运的转折，都伴随着冥冥中这一点运气。</p>
<p>Or maybe every twist of fate in the world is accompanied by a bit of luck.</p>
<h2 id="6-《默读》"><a href="#6-《默读》" class="headerlink" title="6.《默读》"></a>6.《默读》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GWezI1.png" alt="GWezI1.png"></p>
<p>1）我不是凝视深渊的人，我就是深渊。</p>
<p>I’m not the one to gaze at the abssy，I’m the abassy.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWnD9P.png" alt="GWnD9P.png"></p>
<p>2）未经允许，擅自特别喜欢你，实在不好意思。</p>
<p>Without your promision, loving you so much, that was my fault.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWnXNR.png" alt="GWnXNR.png"></p>
<p>3）我心底，有一簇迎着烈日而生的花，</p>
<p>比一切美酒都要芬芳，</p>
<p>滚烫的馨香没过稻草人的胸膛，</p>
<p>草扎的精神，</p>
<p>从此万寿无疆。</p>
<p>In my heart, there is a cluster of flowers facing the sun, </p>
<p>more fragrant than all the wine,</p>
<p> the fragrance of the scarecrow’s chest, </p>
<p>the spirit of the grass, </p>
<p>from now on, forever.</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GWlPzt.png" alt="GWlPzt.png"></p>
<p>4）徘徊的人啊，找到你失去的夜明珠了吗?</p>
<p>Wandering people, have you found your lost pearl?</p>
<p><img src="https://s1.ax1x.com/2020/04/08/GW3854.png" alt="GW3854.png"></p>
<p>5）没有了…怪物都清理干净了…我是最后一个…你可不可以…把我关在你家里…《默读》</p>
<p>None… The monsters are all cleaned up… I was the last one… Would you mind… Lock me up in your house…</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEFtVzhRSzZRNEY1d1dISS96UGxzU3dXWHBvQnNYN2puUHdmUVE5ZHlYN1R3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>6）愿你和旁边的说话不用解释半天，愿你身旁有人愿意和你并肩同行。</p>
<p>Wish you talk with people around without explaining for a long time, wish someone is willing to walk with you.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFXeDE5dGtqS0VRQjJuSThYNFJjd1hJdjljUFlRL1BjV0dZNThlcmx4OGRnPT0.jpg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg" alt="img"> </p>
<p>7）“哥，我想要你。” 这本来只是一句信口而至的调情，可是在说出口的瞬间，却突然在费渡心里卷起了轩然大波，像茫茫雪原中惊破了冻土的不速春风，无中生有，席卷而至，巨大的回响在他肺腑中激荡，震颤不休。 就好像他不经意间吐出了一块带血的真心似的。</p>
<p>“Hey, bro, I want you.” This was just a casual flirtation, but in the moment of saying, suddenly Feidu’s heart rolled up a storm, like a frozen spring wind in the vast snow field, out of nothing, sweeping away, and huge reverberations vibrate in his heart, shaking endlessly. It was as if he had accidentally spat out a bloody piece of his love. </p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNERVWk1qY0tMZ3d2c29hOXk4d2pucDFTZy83UWtPb0Ntd3ZaQ25lUjJ1VlVRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>8)也许是把捂出脓的陈年旧伤重新挖开的缘故，或许痛苦，或许鲜血淋漓，但总有机会重新愈合。</p>
<p>Maybe it’s because the old wound was torn, maybe it was painful, maybe it was bloody, but there will always be a chance to heal.</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNENLYlJEQTFoWFo3SkJ0ZlVmRFpxSUxjT0U0WDlyelhNWm1lZFN3bjU2eHhRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>9)当年那倔强，清澈至于有些偏执的目光，一丝痕迹都不剩了。 它们好像只存在骆闻舟心里，是他自作多情的一个幻觉。</p>
<p>That stubborn and clear to even some paranoid eyes, trace is not left. They seem to exist only in Luo Wenzhou’s mind, they seem to be an illusion of his love.</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNENrUy9Ba3hJT2hjaWpOZnczK3BkcTdmRFdTYjdrZEFyZE5VN1FMamhNZGp3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>10) 没有了那些乱七八糟的纹身贴遮挡，他的胸口单薄而白皙，几乎还带着一点诱人的少年感。 那么浅的胸口，那么深的心。</p>
<p>Without tattoo patches, his chest was thin and white, almost seductively boyish, free of the tattered patches. So shallow the chest, so deep the heart.</p>
<h2 id="7-《逆旅归来》"><a href="#7-《逆旅归来》" class="headerlink" title="7.《逆旅归来》"></a>7.《逆旅归来》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GWuE4I.png" alt="GWuE4I.png"></p>
<p>1）（a poem）</p>
<p>秦淮月 霸陵雪 千秋万古一双人</p>
<p>一代容颜 高楼梦断 一时间</p>
<p>百年离恨 星移斗转了无痕</p>
<p>只教你 来时众众 去时独独</p>
<p>Qinhuai’s moon, Baling’s snow, thousands of year one couple</p>
<p>A generation of appearance, high- rise dream break, in a period of time</p>
<p>A hundred years of hate, stars change without trail</p>
<p>Make you to come together but go alone</p>
<p> <img src="http://imglf6.nosdn0.126.net/img/b2llRE03RXovNEE3MCtiUSswczdMYkFHOFJBaTVsMmFxNmVJUGlwb3NkTTI5T2NXa0R1NVFRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>2）是不是没有希望，也就不知道什么叫失望——这个世界就是这么荒谬，只有尝过糖的人，才明白什么叫苦。</p>
<p>Is it true that if there is no hope, there will be no disappointment? The world is so ridiculous! Only those who have tasted the sweet understand the bitter. </p>
<h2 id="8-《锦瑟》"><a href="#8-《锦瑟》" class="headerlink" title="8.《锦瑟》"></a>8.《锦瑟》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GWMV6f.png" alt="GWMV6f.png"></p>
<p>1）（a poem）</p>
<p>去时全盛红颜子，归时半百白头翁，</p>
<p>纵然乡音未改，故乡和归人，</p>
<p>却都已经面目全非，几乎落得两两不识。</p>
<p>When you go, the flourishing beauty ,</p>
<p>when you back, half hundred old man, </p>
<p>even if the accent has not changed, hometown and homecoming, </p>
<p>have been beyond recognition.</p>
<h2 id="9-《有匪》"><a href="#9-《有匪》" class="headerlink" title="9.《有匪》"></a>9.《有匪》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GWMr1x.png" alt="GWMr1x.png"></p>
<p>1）阿翡，鬼神在六合之外，人世间行走的都是凡人，为何你不敢相信自己手中这把刀能无坚不摧?</p>
<p>Fei，the ghost is outside the boundary, only mortal walk in the world, </p>
<p>why you can’t believe the knife in your hand  able to be indestructible?</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFtOE5tRElYdmJ4OGQ1U00zbWU2ZHE1NUk4NGEyUEFHN0xhaHlJR2pPZFd3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>2）乱世里本就没有王法，如果道义也黯然失声，那么其中苟且偷生的人们，还有什么可期盼的呢?</p>
<p>In troubled times, there is no law. If the moral also lost its voice, what the people who struggle to survive can expecte?</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNERVWk1qY0tMZ3d2Z1hJUUx5TWh3VDVFUFRGaURZRTJWa0J2eTB2OWQvMm1nPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>3)布衣荆钗盖不住倾城国色，吃斋念佛也藏不住野心昭昭。怎么总有人觉得自己能瞒天过海?</p>
<p>Rough clothes and wooden hairpins could not conceal beauty, nor could vegetarianism and buddhist prayer conceal ambition. Why do some people always think they can cheat?</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEIvSy81RjVRcmw3czFFWklUTDRMd2poSDNLOGRxRldvU1dyU2tRdWVzRzJnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>4) 但举世尘埃飞舞，他这一颗却行将落定</p>
<p>But as the dust of the world flutters, he is about to settle. </p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEN3ekdlYk85MUkvSHZlRldYVnRZTytEQlBaT2kxM0FHdzd1dndkbk02M3lnPT0.jpg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>5) 那些倍感束缚的家，总有一天再也回不去。</p>
<p>One day, we will be forever unable to go back to those restrainted homes.</p>
<h2 id="10-《七爷》"><a href="#10-《七爷》" class="headerlink" title="10.《七爷》"></a>10.《七爷》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GWQ6Gn.png" alt="GWQ6Gn.png"></p>
<p>1）彼岸花开了一路，血似的。忘川水静静地淌过，三千年往东，三千年往西。</p>
<p>Equinox Flower opened all the way, like blood. Wangchuan river quietly flowing, three thousand years to the east, three thousand years to the west.</p>
<h2 id="11-《坏道》"><a href="#11-《坏道》" class="headerlink" title="11.《坏道》"></a>11.《坏道》</h2><p><img src="https://s1.ax1x.com/2020/04/08/GW1ApR.png" alt="GW1ApR.png"></p>
<p>1）不得不说，其实有的时候，演戏真的是一种天份。</p>
<p>I have to say, sometimes acting is really a gift.</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEFtVzhRSzZRNEY1M2hlWkJHYzl4Y3d4d1lxeExVSEZ0bUxaaEVqOGlzTG1RPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>2）有时候地狱是存在的，就在人的心里，终生相随，萦绕不去，不死不休。</p>
<p>Sometimes the hell exists, in the heart of the people, with the whole lifetime, haunted, never dying for ever more.</p>
<h2 id="12-《大哥》"><a href="#12-《大哥》" class="headerlink" title="12.《大哥》"></a>12.《大哥》</h2><p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEF0WHc5UVpaUENlN1NZSjdtU1pyQjhLZU9aRGliYkJIT0lpdUIyZDB5YXhnPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>1）这小少年的心就像一片海，表面上平静无波，似乎总是理性而宁静的，内里却蕴含了巨大的叛逆和此起彼伏的躁动，长期平衡在一个危险的、一触即发的临界点上。</p>
<p>The little boy’s heart is like a sea, calm and waveless on the surface, always seems to be rational and quiet. But it contains a great rebellion and restlessness. In long term, it balances in a dangerous brink of the point.</p>
<p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEIyK0ExWno0TVMvZko3eGdNM09IMEJjR1pMZFkzVUh4cXI5bmhldTJPTnF3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>2)可是一个人真会为了另一个人神魂颠倒吗?</p>
<p>But can one really fall head over heels for another?</p>
<p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNEFXeDE5dGtqS0VRQTRnbmhGelc3ZWhqdUhERWtpd3p1N2VsTHEwUWVYVXJRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>3）有时候那些看似奇迹的命运，要是刨根问底，竟然也会是人为。</p>
<p>Sometimes those seemingly miraculous destinies, if questioned, will be artificial.</p>
<h2 id="13-《天涯客》"><a href="#13-《天涯客》" class="headerlink" title="13.《天涯客》"></a>13.《天涯客》</h2><p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEFtOE5tRElYdmJ4N3JlbUxvY1RjVlRvVnNMM0pZbytZVGFUMHFhQkZWVFJBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>1）江湖么，走到哪都有是非，朝堂是个名利场，江湖便是个是非场，有人总想不明白这件事，好像仗剑骑马走天涯是件多了不得的事似的，临死都念叨着。</p>
<p>Jianghu is a place that wherever you go, there are disputes. The dynasty hall is a fame and fortune fair, jianghu is a dispute field. Someone always can’t understand this matter, as if riding a horse with sword throughout the world is a matter of more than a lot, reciting even when dying.</p>
<p>*<em>为了看看“江湖”咋翻搜了好久，结果看到翻金庸小说里面的直接翻成“jianghu”。因为其实英语里没有特别合适的词，就留给读者自己想象去吧，毕竟不同的人心中有不一样的江湖。 *</em></p>
<p><strong>‘Jianghu’ isn’t a easy word to be translated, there isn’t a corresponding worf in English(silmilar to the whole world). I searched and found that, in Jinyong’s(a famous Chinese writer) books translation, it is just called  ‘Jianghu’. Everyone has their own thought of Jianghu, so we can leave the word to themselves to imagine.</strong></p>
<h2 id="14-《过门》"><a href="#14-《过门》" class="headerlink" title="14.《过门》"></a>14.《过门》</h2><p> <img src="http://imglf5.nosdn0.126.net/img/b2llRE03RXovNEI5QUpoTmJiMWFubDdXMkxRZzUzMlFtRmN4eWJpQzdJVnNJckV2aGR1UDdBPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0" alt="img"> </p>
<p>1）人很多痛苦，都来自于过多的怀念。如果对“过去”没有执念，懂得“过去就是过去了”的道理，就不太会畏惧生活会变得面目全非。</p>
<p>A lot of people’s pain is from too much memory of the past. If you don’t cling to the past and understand that the past is the past, you won’t be afraid that your life will change beyond recognition.</p>
<h2 id="15-《烈火浇愁》"><a href="#15-《烈火浇愁》" class="headerlink" title="15.《烈火浇愁》"></a>15.《烈火浇愁》</h2><p> <img src="http://imglf3.nosdn0.126.net/img/b2llRE03RXovNENrUy9Ba3hJT2hjbk9vejlNKytpUmFrcUxYaFVOaWJ2QmJHRGVJZ3ZOUXFRPT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>1) 初相识，便刻骨铭心。 </p>
<p>First acquaintance made them remember forever.</p>
<p> <img src="http://imglf4.nosdn0.126.net/img/b2llRE03RXovNEN3ekdlYk85MUkvSHhOOW5qTHRoN2NiWFRJRVFaaGlJdDlGa3pNOCtUblNRPT0.jpg?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg%7Cwatermark&type=2&text=wqkg5bmy5LqG6L-Z55O25YGH6YWSIC8gZ2FubGV6aGVpcGluZ2ppYWppdS5sb2Z0ZXIuY29t&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=240&dx=8&dy=10&stripmeta=0" alt="img"> </p>
<p>2) 原来史书上所有的一笔着会过，去象轻第有万千心机。</p>
<p>It turns out that the events in history, which are counted over, always have thousands of scheming.</p>
<h2 id="MY-THOUGHT"><a href="#MY-THOUGHT" class="headerlink" title="MY THOUGHT"></a>MY THOUGHT</h2><p><strong>1.Someone said it was better to use ‘In the bottom of the muck,I found my lucida. ‘. I can learn from this.</strong></p>
<p><strong>2.‘Jianghu’ isn’t a easy word to be translated, there isn’t a corresponding worf in English(silmilar to the whole world). I searched and found that, in Jinyong’s(a famous Chinese writer) books translation, it is just called  ‘Jianghu’. Everyone has their own thought of Jianghu, so we can leave the word to themselves to imagine.</strong></p>
<p><strong>3.Despite the new vocabulary I can learn during this time, the sentences can really tell some truth.</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/04/08/%E7%BF%BB%E8%AF%91Translation/" data-id="ckbw9eiqs001v34urhi3a4loe" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/translation/" rel="tag">-translation</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-有关海华AI比赛6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/31/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B6/" class="article-date">
  <time datetime="2020-03-31T02:42:07.000Z" itemprop="datePublished">2020-03-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B5%B7%E5%8D%8EAI-competition/">海华AI competition</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/31/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B6/">有关海华AI比赛6</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="06-1-Observe-hidden-layers"><a href="#06-1-Observe-hidden-layers" class="headerlink" title="06.1.Observe hidden layers"></a>06.1.Observe hidden layers</h1><p>Code by <a href="https://github.com/csy-tvgo" target="_blank" rel="noopener">karbon</a><br>This notebook is a modified version of <code>04.2.MNIST and CNN.ipynb</code> in order to observe the hidden layers.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import, division, print_function, unicode_literals</span><br><span class="line"></span><br><span class="line"><span class="comment"># TensorFlow and tf.keras</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Helper libraries</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">print(tf.__version__)</span><br></pre></td></tr></table></figure>

<h2 id="Import-MNIST-dataset-and-preprocess-the-dataset"><a href="#Import-MNIST-dataset-and-preprocess-the-dataset" class="headerlink" title="Import MNIST dataset and preprocess the dataset"></a>Import MNIST dataset and preprocess the dataset</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mnist = keras.datasets.mnist</span><br><span class="line"></span><br><span class="line">(train_images, train_labels), (test_images, test_labels) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># grayscale image has only 1 channal</span></span><br><span class="line"><span class="keyword">if</span> K.image_data_format() == <span class="string">'channels_first'</span>:</span><br><span class="line">    train_images = train_images.reshape(train_images.shape[<span class="number">0</span>], <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line">    test_images = test_images.reshape(test_images.shape[<span class="number">0</span>], <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line">    input_shape = (<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    train_images = train_images.reshape(train_images.shape[<span class="number">0</span>], <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    test_images = test_images.reshape(test_images.shape[<span class="number">0</span>], <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    input_shape = (<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">train_images_normed = train_images / <span class="number">255.0</span></span><br><span class="line">test_images_normed = test_images / <span class="number">255.0</span></span><br><span class="line">train_labels_onehot = keras.utils.to_categorical(train_labels, <span class="number">10</span>)</span><br><span class="line">test_labels_onehot = keras.utils.to_categorical(test_labels, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Build-the-model-and-train"><a href="#Build-the-model-and-train" class="headerlink" title="Build the model and train"></a>Build the model and train</h2><p>This example is <a href="http://yann.lecun.com/exdb/lenet/" target="_blank" rel="noopener">LeNet-5</a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">model = keras.Sequential([</span><br><span class="line">    keras.layers.Conv2D(<span class="number">6</span>, kernel_size=(<span class="number">5</span>, <span class="number">5</span>),</span><br><span class="line">                 activation=<span class="string">'relu'</span>,</span><br><span class="line">                 input_shape=input_shape),</span><br><span class="line">    keras.layers.MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line">    keras.layers.Conv2D(<span class="number">16</span>, kernel_size=(<span class="number">5</span>, <span class="number">5</span>), activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line">    keras.layers.Flatten(),</span><br><span class="line">    keras.layers.Dense(<span class="number">120</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.Dense(<span class="number">84</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.Dense(<span class="number">10</span>, activation=<span class="string">'softmax'</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model.compile(loss=keras.losses.categorical_crossentropy,</span><br><span class="line">              optimizer=keras.optimizers.Adam(),</span><br><span class="line">              metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line"></span><br><span class="line">model.fit(train_images_normed, train_labels_onehot, batch_size=<span class="number">100</span>, epochs=<span class="number">6</span>)</span><br><span class="line"><span class="comment"># It may need more than one minute</span></span><br></pre></td></tr></table></figure>

<h2 id="Make-prediction-and-observe-the-hidden-layers"><a href="#Make-prediction-and-observe-the-hidden-layers" class="headerlink" title="Make prediction and observe the hidden layers"></a>Make prediction and observe the hidden layers</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.summary()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">num = random.randint(<span class="number">0</span>, len(test_images))</span><br><span class="line">inputImg = test_images[num]</span><br><span class="line">inputImg = np.expand_dims(inputImg, axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">predictions = model.predict(test_images_normed)</span><br><span class="line"></span><br><span class="line">layer1 = Model(inputs=model.input, outputs=model.get_layer(index=<span class="number">0</span>).output)</span><br><span class="line">layer1_output = layer1.predict(inputImg)</span><br><span class="line">layer2 = Model(inputs=model.input, outputs=model.get_layer(index=<span class="number">1</span>).output)</span><br><span class="line">layer2_output = layer2.predict(inputImg)</span><br><span class="line">layer3 = Model(inputs=model.input, outputs=model.get_layer(index=<span class="number">2</span>).output)</span><br><span class="line">layer3_output = layer3.predict(inputImg)</span><br><span class="line">layer4 = Model(inputs=model.input, outputs=model.get_layer(index=<span class="number">3</span>).output)</span><br><span class="line">layer4_output = layer4.predict(inputImg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">18</span>,<span class="number">18</span>))</span><br><span class="line">plt.subplot(<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">plt.imshow(inputImg[<span class="number">0</span>,:,:,<span class="number">0</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    img = layer1_output[<span class="number">0</span>, :, :, i]</span><br><span class="line">    plt.subplot(<span class="number">5</span>,<span class="number">6</span>,i+<span class="number">7</span>)</span><br><span class="line">    plt.imshow(img)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    img = layer2_output[<span class="number">0</span>, :, :, i]</span><br><span class="line">    plt.subplot(<span class="number">5</span>,<span class="number">6</span>,i+<span class="number">13</span>)</span><br><span class="line">    plt.imshow(img)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    img = layer3_output[<span class="number">0</span>, :, :, i]</span><br><span class="line">    plt.subplot(<span class="number">10</span>,<span class="number">8</span>,i+<span class="number">49</span>)</span><br><span class="line">    plt.imshow(img)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    img = layer4_output[<span class="number">0</span>, :, :, i]</span><br><span class="line">    plt.subplot(<span class="number">10</span>,<span class="number">8</span>,i+<span class="number">65</span>)</span><br><span class="line">    plt.imshow(img)</span><br></pre></td></tr></table></figure>

<p>  <img src="https://s1.ax1x.com/2020/03/31/GKN4aV.png" alt="GKN4aV.png"></p>
<h1 id="06-2-Better-training-methods"><a href="#06-2-Better-training-methods" class="headerlink" title="06.2.Better training methods"></a>06.2.Better training methods</h1><p> <strong><em>Attention!</em></strong> Before running this notebook, you need to run <code>05.1.ReadAnnotationsFromJSON.ipynb</code> before </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import, division, print_function, unicode_literals</span><br><span class="line"></span><br><span class="line"><span class="comment"># TensorFlow and tf.keras</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.callbacks <span class="keyword">import</span> LearningRateScheduler</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing <span class="keyword">import</span> image</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Helper libraries</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'SimHei'</span>]  <span class="comment"># 用来正常显示中文标签</span></span><br><span class="line">plt.rcParams[<span class="string">'axes.unicode_minus'</span>] = <span class="literal">False</span>  <span class="comment"># 用来正常显示负号</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line">print(tf.__version__)</span><br></pre></td></tr></table></figure>

<h2 id="Import-dataset-and-preprocessing"><a href="#Import-dataset-and-preprocessing" class="headerlink" title="Import dataset and preprocessing"></a>Import dataset and preprocessing</h2><p>Because our dataset is a bit large, RAM may not be enough to directly load all images. We can use <code>flow_from_dataframe</code> to load our dataset. (click <a href="https://keras.io/preprocessing/image/" target="_blank" rel="noopener">here</a> to read more about this function)<br>First, load labels from our <code>.csv</code> file. We use <code>pandas.read_csv</code>, it loads csv file to <code>DataFrame</code> format.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">"./dataset/resizedFullGarbageDataset/train.csv"</span>, encoding=<span class="string">'gbk'</span>, dtype=str)</span><br><span class="line">df = df.sample(frac=<span class="number">1</span>).reset_index(drop=<span class="literal">True</span>) <span class="comment"># shuffle the datadrame</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p> Then, use <code>keras.preprocessing.image.ImageDataGenerator</code> to load trainset.<br>You can add data augumentation settings in this function. Read <a href="https://keras.io/preprocessing/image/" target="_blank" rel="noopener">more about this function</a>. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">batch_size = <span class="number">32</span> <span class="comment">#number one time</span></span><br><span class="line">sizeX, sizeY = <span class="number">112</span>, <span class="number">112</span> <span class="comment">#size</span></span><br><span class="line">apply_DataAugumentation = <span class="literal">True</span> <span class="comment">#数据增强 change the picture in different way to increase the database</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> apply_DataAugumentation:</span><br><span class="line">    datagen=ImageDataGenerator(rescale=<span class="number">1.</span>/<span class="number">255</span>, </span><br><span class="line">                               validation_split=<span class="number">0.1</span>,</span><br><span class="line">                               rotation_range=<span class="number">15</span>, <span class="comment">#旋转角度 rotation angle</span></span><br><span class="line">                               width_shift_range=<span class="number">0.2</span>, <span class="comment">#大小 size</span></span><br><span class="line">                               height_shift_range=<span class="number">0.2</span>,</span><br><span class="line">                               horizontal_flip=<span class="literal">True</span>, <span class="comment">#水平镜像 reflection</span></span><br><span class="line">                               vertical_flip=<span class="literal">False</span>, <span class="comment">#垂直镜像</span></span><br><span class="line">                               zoom_range=[<span class="number">0.8</span>, <span class="number">1</span>], <span class="comment">#缩放 zoom</span></span><br><span class="line">                               fill_mode=<span class="string">'reflect'</span></span><br><span class="line">                              )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    datagen=ImageDataGenerator(rescale=<span class="number">1.</span>/<span class="number">255</span>, validation_split=<span class="number">0.1</span>) <span class="comment">#10% is test group</span></span><br><span class="line">                          </span><br><span class="line">                          </span><br><span class="line">trainset = datagen.flow_from_dataframe(dataframe=df, directory=<span class="string">'./dataset/resizedFullGarbageDataset/train_resized'</span>,</span><br><span class="line">                                       x_col=<span class="string">'filename'</span>, y_col=<span class="string">'name'</span>, class_mode=<span class="string">'categorical'</span>, target_size=(sizeX,sizeY),</span><br><span class="line">                                       batch_size=batch_size, shuffle=<span class="literal">True</span>, seed=<span class="number">42</span>, subset=<span class="string">'training'</span>)</span><br><span class="line">testset = datagen.flow_from_dataframe(dataframe=df, directory=<span class="string">'./dataset/resizedFullGarbageDataset/train_resized'</span>,</span><br><span class="line">                                      x_col=<span class="string">'filename'</span>, y_col=<span class="string">'name'</span>, class_mode=<span class="string">'categorical'</span>, target_size=(sizeX,sizeY),</span><br><span class="line">                                      batch_size=batch_size, shuffle=<span class="literal">True</span>, seed=<span class="number">42</span>, subset=<span class="string">'validation'</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">names = trainset.class_indices</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getname</span><span class="params">(index)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> list(names)[index] <span class="comment">#ues numbers to replace the names of different objects</span></span><br><span class="line"></span><br><span class="line">names</span><br></pre></td></tr></table></figure>

<p> <code>trainset[i]</code> has two parts. <code>trainset[i][0]</code> is the i-th batch of image, while <code>trainset[i][1]</code> is one-hot encodings which represents classes. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">16</span>,<span class="number">8</span>))</span><br><span class="line">n = <span class="number">123</span> <span class="comment"># index of the batch you want to observe</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    plt.subplot(<span class="number">2</span>,<span class="number">4</span>,i+<span class="number">1</span>)</span><br><span class="line">    plt.imshow(trainset[n][<span class="number">0</span>][i])</span><br><span class="line">    index = np.argmax(trainset[n][<span class="number">1</span>][i])</span><br><span class="line">    plt.xlabel(str(index) + <span class="string">':'</span> + getname(index))</span><br></pre></td></tr></table></figure>

<p>example:</p>
<p><img src="https://s1.ax1x.com/2020/03/31/GKB2MF.png" alt="GKB2MF.png"></p>
<h2 id="Import-a-pre-trained-model-without-prediction-layers-as-feature-extractor"><a href="#Import-a-pre-trained-model-without-prediction-layers-as-feature-extractor" class="headerlink" title="Import a pre-trained model without prediction layers as feature extractor"></a>Import a pre-trained model without prediction layers as feature extractor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">input_shape = (sizeX, sizeY, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.applications.inception_v3 <span class="keyword">import</span> InceptionV3  <span class="comment"># use InceptionV3 as example </span></span><br><span class="line"><span class="comment">#we can change the model(from Keras documentation)</span></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.applications.inception_v3 <span class="keyword">import</span> preprocess_input, decode_predictions <span class="comment">#the function in the model </span></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.regularizers <span class="keyword">import</span> l2</span><br><span class="line"></span><br><span class="line">base_model = InceptionV3(weights=<span class="string">'imagenet'</span>, include_top=<span class="literal">False</span>, input_shape=input_shape)</span><br><span class="line"><span class="comment">#the setting is according to the Keras Documentation</span></span><br><span class="line">base_model.summary()</span><br></pre></td></tr></table></figure>

<h2 id="Add-prediction-layers"><a href="#Add-prediction-layers" class="headerlink" title="Add prediction layers"></a>Add prediction layers</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = base_model.output</span><br><span class="line">x = keras.layers.AveragePooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>))(x)</span><br><span class="line">x = keras.layers.Dropout(<span class="number">.4</span>)(x)</span><br><span class="line">x = keras.layers.Flatten()(x)</span><br><span class="line">x = keras.layers.Dense(<span class="number">198</span>, kernel_initializer=<span class="string">'glorot_uniform'</span>, kernel_regularizer=l2(<span class="number">.0005</span>), activation=<span class="string">'softmax'</span>)(x)</span><br><span class="line"></span><br><span class="line">model_finetune = Model(inputs=base_model.input, outputs=x)</span><br><span class="line"></span><br><span class="line">model_finetune.summary()</span><br></pre></td></tr></table></figure>

<h2 id="Define-optimizer-and-compile-the-model"><a href="#Define-optimizer-and-compile-the-model" class="headerlink" title="Define optimizer and compile the model"></a>Define optimizer and compile the model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">schedule</span><span class="params">(epoch)</span>:</span>   <span class="comment">#change the length of every step according to the epoch</span></span><br><span class="line">    <span class="keyword">if</span> epoch &lt;= <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">.01</span></span><br><span class="line">    <span class="keyword">elif</span> epoch &lt;= <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">.002</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">.0004</span> <span class="comment">#change the step as the epoch change</span></span><br><span class="line">lr_scheduler = LearningRateScheduler(schedule)</span><br><span class="line"></span><br><span class="line">sgd = keras.optimizers.SGD(lr=<span class="number">.01</span>, momentum=<span class="number">.9</span>)</span><br><span class="line"></span><br><span class="line">model_finetune.compile(loss=keras.losses.categorical_crossentropy,</span><br><span class="line">              optimizer=sgd,</span><br><span class="line">              metrics=[<span class="string">"accuracy"</span>])</span><br></pre></td></tr></table></figure>

<h2 id="Start-learning"><a href="#Start-learning" class="headerlink" title="Start learning"></a>Start learning</h2><p>Because the dataset is large, <em>it may take a <strong>very long</strong> time.</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">STEP_SIZE_TRAIN=trainset.n//trainset.batch_size</span><br><span class="line">STEP_SIZE_VALID=testset.n//testset.batch_size</span><br><span class="line">print(STEP_SIZE_TRAIN, STEP_SIZE_VALID)</span><br><span class="line"></span><br><span class="line">model_finetune.fit_generator(generator=trainset,</span><br><span class="line">                    steps_per_epoch=STEP_SIZE_TRAIN,</span><br><span class="line">                    validation_data=testset,</span><br><span class="line">                    validation_steps=STEP_SIZE_VALID,</span><br><span class="line">                    epochs=<span class="number">10</span>, <span class="comment">#this control the times it runs, the more the more accurate,but it have a top value</span></span><br><span class="line">                    callbacks=[lr_scheduler]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="Evaluate-the-model"><a href="#Evaluate-the-model" class="headerlink" title="Evaluate the model"></a>Evaluate the model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model_finetune.evaluate_generator(testset,verbose=<span class="number">1</span>) <span class="comment">#add more layer</span></span><br></pre></td></tr></table></figure>

<h2 id="Save-the-trained-model"><a href="#Save-the-trained-model" class="headerlink" title="Save the trained model"></a>Save the trained model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">modelname = <span class="string">'finetuneExample0-9964'</span> </span><br><span class="line">model_finetune.save(<span class="string">'./trainedModels/'</span> + modelname + <span class="string">'.h5'</span>)</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/03/31/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B6/" data-id="ckbw9eiqr001s34urfk3f1g8u" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Competition/" rel="tag">Competition</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-b站bv转av" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/26/b%E7%AB%99bv%E8%BD%ACav/" class="article-date">
  <time datetime="2020-03-26T11:12:16.000Z" itemprop="datePublished">2020-03-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/daily/">daily</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/26/b%E7%AB%99bv%E8%BD%ACav/">b站bv转av</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>b站将av视频号换成了更高级的bv号，转化代码如下：（python）<br>bv to av：</p>


<div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">
    <iframe src="//player.bilibili.com/player.html?aid=99160403&bvid=BV1R7411y7kw&cid=169272770&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;">
    </iframe>
</div>


<p>av to bv：</p>


<div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">
    <iframe src="//player.bilibili.com/player.html?aid=98869161&bvid=BV1N741127Tj&cid=169275257&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;">
    </iframe>
</div>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#bv to av:</span></span><br><span class="line">bv=input()</span><br><span class="line">c=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> bv:</span><br><span class="line">    c=c+[i]</span><br><span class="line">c=c[<span class="number">2</span>:]</span><br><span class="line">table=&#123;<span class="string">'1'</span>:<span class="number">13</span>,<span class="string">'2'</span>:<span class="number">12</span>,<span class="string">'3'</span>:<span class="number">46</span>,<span class="string">'4'</span>:<span class="number">31</span>,<span class="string">'5'</span>:<span class="number">43</span>,<span class="string">'6'</span>:<span class="number">18</span>,<span class="string">'7'</span>:<span class="number">40</span>,<span class="string">'8'</span>:<span class="number">28</span>,<span class="string">'9'</span>:<span class="number">5</span>,<span class="string">'A'</span>:<span class="number">54</span>,<span class="string">'B'</span>:<span class="number">20</span>,<span class="string">'C'</span>:<span class="number">15</span>,<span class="string">'D'</span>:<span class="number">8</span>,<span class="string">'E'</span>:<span class="number">39</span>,<span class="string">'F'</span>:<span class="number">57</span>,<span class="string">'G'</span>:<span class="number">45</span>,<span class="string">'H'</span>:<span class="number">36</span>,<span class="string">'J'</span>:<span class="number">38</span>,<span class="string">'K'</span>:<span class="number">51</span>,</span><br><span class="line">      <span class="string">'L'</span>:<span class="number">42</span>,<span class="string">'M'</span>:<span class="number">49</span>,<span class="string">'N'</span>:<span class="number">52</span>,<span class="string">'P'</span>:<span class="number">53</span>,<span class="string">'Q'</span>:<span class="number">7</span>,<span class="string">'R'</span>:<span class="number">4</span>,<span class="string">'S'</span>:<span class="number">9</span>,<span class="string">'T'</span>:<span class="number">50</span>,<span class="string">'U'</span>:<span class="number">10</span>,<span class="string">'V'</span>:<span class="number">44</span>,<span class="string">'W'</span>:<span class="number">34</span>,<span class="string">'X'</span>:<span class="number">6</span>,<span class="string">'Y'</span>:<span class="number">25</span>,<span class="string">'Z'</span>:<span class="number">1</span>,<span class="string">'a'</span>:<span class="number">26</span>,<span class="string">'b'</span>:<span class="number">29</span>,<span class="string">'c'</span>:<span class="number">56</span>,<span class="string">'d'</span>:<span class="number">3</span>,<span class="string">'e'</span>:<span class="number">24</span>,<span class="string">'f'</span>:<span class="number">0</span>,</span><br><span class="line">      <span class="string">'g'</span>:<span class="number">47</span>,<span class="string">'h'</span>:<span class="number">27</span>,<span class="string">'i'</span>:<span class="number">22</span>,<span class="string">'j'</span>:<span class="number">41</span>,<span class="string">'k'</span>:<span class="number">16</span>,<span class="string">'m'</span>:<span class="number">11</span>,<span class="string">'n'</span>:<span class="number">37</span>,<span class="string">'o'</span>:<span class="number">2</span>,<span class="string">'p'</span>:<span class="number">35</span>,<span class="string">'q'</span>:<span class="number">21</span>,<span class="string">'r'</span>:<span class="number">17</span>,<span class="string">'s'</span>:<span class="number">33</span>,<span class="string">'t'</span>:<span class="number">30</span>,<span class="string">'u'</span>:<span class="number">48</span>,<span class="string">'v'</span>:<span class="number">23</span>,<span class="string">'w'</span>:<span class="number">55</span>,<span class="string">'x'</span>:<span class="number">32</span>,<span class="string">'y'</span>:<span class="number">14</span>,<span class="string">'z'</span>:<span class="number">19</span>&#125;</span><br><span class="line">d=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(bv)<span class="number">-2</span>):</span><br><span class="line">    d=d+[table[c[i]]]</span><br><span class="line">f=d[<span class="number">0</span>]*<span class="number">58</span>**<span class="number">6</span>+d[<span class="number">1</span>]*<span class="number">58</span>**<span class="number">2</span>+d[<span class="number">2</span>]*<span class="number">58</span>**<span class="number">4</span>+d[<span class="number">3</span>]*<span class="number">58</span>**<span class="number">8</span>+d[<span class="number">4</span>]*<span class="number">58</span>**<span class="number">5</span>+d[<span class="number">5</span>]*<span class="number">58</span>**<span class="number">9</span>+d[<span class="number">6</span>]*<span class="number">58</span>**<span class="number">3</span>+d[<span class="number">7</span>]*<span class="number">58</span>**<span class="number">7</span>+d[<span class="number">8</span>]*<span class="number">58</span>+d[<span class="number">9</span>]</span><br><span class="line">f=bin(f<span class="number">-100618342136696320</span>)</span><br><span class="line">f=list(f[<span class="number">2</span>:])</span><br><span class="line">g=<span class="number">0</span></span><br><span class="line">h=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">'1010100100111011001100100100'</span>:</span><br><span class="line">    <span class="keyword">if</span> f[g]==str(i):</span><br><span class="line">        h=h+[<span class="string">'0'</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        h=h+[<span class="string">'1'</span>]</span><br><span class="line">    g=g+<span class="number">1</span></span><br><span class="line">av=<span class="string">''</span>.join(h)</span><br><span class="line">av=<span class="string">'av'</span>+str(int(h,<span class="number">2</span>))</span><br><span class="line">print(av)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#示例：input：bv17x411w7KC</span></span><br><span class="line"><span class="comment">#     output：av170001</span></span><br></pre></td></tr></table></figure>

<h2 id="代码原版："><a href="#代码原版：" class="headerlink" title="代码原版："></a>代码原版：</h2><p>作者(author)：mcfx<br>链接(link)：<a href="https://www.zhihu.com/question/381784377/answer/1099438784" target="_blank" rel="noopener">https://www.zhihu.com/question/381784377/answer/1099438784</a><br>来源(from)：知乎</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">table=<span class="string">'fZodR9XQDSUm21yCkr6zBqiveYah8bt4xsWpHnJE7jL5VG3guMTKNPAwcF'</span></span><br><span class="line">tr=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">58</span>):</span><br><span class="line">    tr[table[i]]=i</span><br><span class="line">s=[<span class="number">11</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>]</span><br><span class="line">xor=<span class="number">177451812</span></span><br><span class="line">add=<span class="number">8728348608</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span><span class="params">(x)</span>:</span></span><br><span class="line">    r=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        r+=tr[x[s[i]]]*<span class="number">58</span>**i</span><br><span class="line">    <span class="keyword">return</span> (r-add)^xor</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span><span class="params">(x)</span>:</span></span><br><span class="line">    x=(x^xor)+add</span><br><span class="line">    r=list(<span class="string">'BV1  4 1 7  '</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        r[s[i]]=table[x//<span class="number">58</span>**i%<span class="number">58</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(r)</span><br><span class="line"></span><br><span class="line">print(dec(<span class="string">'BV17x411w7KC'</span>))</span><br><span class="line">print(dec(<span class="string">'BV1Q541167Qg'</span>))</span><br><span class="line">print(dec(<span class="string">'BV1mK4y1C7Bz'</span>))</span><br><span class="line">print(enc(<span class="number">170001</span>))</span><br><span class="line">print(enc(<span class="number">455017605</span>))</span><br><span class="line">print(enc(<span class="number">882584971</span>))</span><br><span class="line"><span class="comment">#out:</span></span><br><span class="line"><span class="comment">#170001</span></span><br><span class="line"><span class="comment">#455017605</span></span><br><span class="line"><span class="comment">#882584971</span></span><br><span class="line"><span class="comment">#BV17x411w7KC</span></span><br><span class="line"><span class="comment">#BV1Q541167Qg</span></span><br><span class="line"><span class="comment">#BV1mK4y1C7Bz</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/03/26/b%E7%AB%99bv%E8%BD%ACav/" data-id="ckbw9eiq1000b34ur6lisdx8c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">-python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-有关海华AI比赛5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B5/" class="article-date">
  <time datetime="2020-03-23T11:56:23.000Z" itemprop="datePublished">2020-03-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B5%B7%E5%8D%8EAI-competition/">海华AI competition</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B5/">有关海华AI比赛5</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="05-1-Read-annotations-from-JSON-file"><a href="#05-1-Read-annotations-from-JSON-file" class="headerlink" title="05.1.Read annotations from JSON file"></a>05.1.Read annotations from JSON file</h1><h2 id="Import-packages"><a href="#Import-packages" class="headerlink" title="Import packages"></a>Import packages</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*- </span></span><br><span class="line"><span class="comment"># import packages</span></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> random</span><br></pre></td></tr></table></figure>

<h2 id="Open-JSON-file"><a href="#Open-JSON-file" class="headerlink" title="Open JSON file"></a>Open JSON file</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'./dataset/resizedFullGarbageDataset/train.json'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    train_labels = json.load(f) <span class="comment">#read the file</span></span><br></pre></td></tr></table></figure>

<h2 id="Observe-the-data-format"><a href="#Observe-the-data-format" class="headerlink" title="Observe the data format"></a>Observe the data format</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_labels <span class="comment">#observe the types of the data</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">out:&#123;&#39;info&#39;: None,</span><br><span class="line">     &#39;lincenses&#39;: None,</span><br><span class="line">     &#39;images&#39;: [&#123;&#39;file_name&#39;: &#39;images_withoutrect&#x2F;11003.png&#39;,</span><br><span class="line">     &#39;height&#39;: 1080,</span><br><span class="line">     &#39;width&#39;: 1920,</span><br><span class="line">     &#39;image_id&#39;: 11003&#125;,</span><br><span class="line">     &#123;&#39;file_name&#39;: &#39;images_withoutrect&#x2F;11004.png&#39;,</span><br><span class="line">      &#39;height&#39;: 1080,</span><br><span class="line">      &#39;width&#39;: 1920,</span><br><span class="line">      &#39;image_id&#39;: 11004&#125;,</span><br><span class="line">      ......</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(train_labels) <span class="comment">#find the tye of the labels</span></span><br><span class="line"><span class="comment">#out:dict</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">train_labels.keys()</span><br><span class="line"><span class="comment">#out:dict_keys(['info', 'lincenses', 'images', 'type', 'annotations', 'categories'])</span></span><br></pre></td></tr></table></figure>

<h2 id="Read-categories"><a href="#Read-categories" class="headerlink" title="Read categories"></a>Read categories</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_labels[<span class="string">'categories'</span>] <span class="comment">#print the categories</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">out:[&#123;&#39;id&#39;: 1, &#39;name&#39;: &#39;瓜子壳&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: 2, &#39;name&#39;: &#39;核桃&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: 3, &#39;name&#39;: &#39;花生壳&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: 4, &#39;name&#39;: &#39;毛豆壳&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: 5, &#39;name&#39;: &#39;西瓜子&#39;&#125;,</span><br><span class="line">     &#123;&#39;id&#39;: 6, &#39;name&#39;: &#39;枣核&#39;&#125;,</span><br><span class="line">     ......</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(train_labels[<span class="string">'categories'</span>])</span><br><span class="line"><span class="comment">#out:list</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">train_labels[<span class="string">'categories'</span>][<span class="number">0</span>]<span class="comment">#choose the first one</span></span><br><span class="line"><span class="comment">#out:&#123;'id': 1, 'name': '瓜子壳'&#125;</span></span><br></pre></td></tr></table></figure>

<p> Convert to list in order to use easier. <strong>(Attention: <code>id</code> begins at 1, while the index of list begins at 0)</strong> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">names = []</span><br><span class="line"><span class="keyword">for</span> label <span class="keyword">in</span> train_labels[<span class="string">'categories'</span>]:</span><br><span class="line">    names.append(label[<span class="string">'name'</span>])</span><br><span class="line">print(names) <span class="comment">#put the categories into a list and show it</span></span><br></pre></td></tr></table></figure>

<p>#out:[‘瓜子壳’, ‘核桃’, ‘花生壳’, ‘毛豆壳’, ‘西瓜子’, ‘枣核’, ‘话梅核’, ‘苹果皮’, ‘柿子皮’, ‘西瓜皮’, ‘香蕉皮’, ‘柚子皮’, ‘荔枝壳’, ‘芒果皮’, ‘苹果核’, ‘干果’, ‘桔子皮’, ‘饼干’, ‘面包’, ‘糖果’, ‘宠物饲料’, ‘风干食品’, ‘蜜饯’, ‘肉干’, ‘冲泡饮料粉’, ‘奶酪’, ‘罐头’, ‘糕饼’, ‘薯片’, ‘树叶’, ‘杂草’, ‘绿植’, ‘鲜花’, ‘豆类’, ‘动物内脏’, ‘绿豆饭’, ‘谷类及加工物’, ‘贝类去硬壳’, ‘虾’, ‘面食’, ‘肉类’, ‘五谷杂粮’, ‘排骨-小肋排’, ‘鸡’, ‘鸡骨头’, ‘螺蛳’, ‘鸭’, ‘鱼’, ‘菜根’, ‘菜叶’, ‘菌菇类’, ‘鱼鳞’, ‘调料’, ‘茶叶渣’, ‘咖啡渣’, ‘粽子’, ‘动物蹄’, ‘小龙虾’, ‘蟹壳’, ‘酱料’, ‘鱼骨头’, ‘蛋壳’, ‘中药材’, ‘中药渣’, ‘镜子’, ‘玻璃制品’, ‘窗玻璃’, ‘碎玻璃片’, ‘化妆品玻璃瓶’, ‘食品及日用品玻璃瓶罐’, ‘保温杯’, ‘玻璃杯’, ‘图书期刊’, ‘报纸’, ‘食品外包装盒’, ‘鞋盒’, ‘利乐包’, ‘广告单’, ‘打印纸’, ‘购物纸袋’, ‘日历’, ‘快递纸袋’, ‘信封’, ‘烟盒’, ‘易拉罐’, ‘金属制品’, ‘吸铁石’, ‘铝制品’, ‘金属瓶罐’, ‘金属工具’, ‘罐头盒’, ‘勺子’, ‘菜刀’, ‘叉子’, ‘锅’, ‘金属筷子’, ‘数据线’, ‘塑料玩具’, ‘矿泉水瓶’, ‘塑料泡沫’, ‘塑料包装’, ‘硬塑料’, ‘一次性塑料餐盒餐具’, ‘电线’, ‘塑料衣架’, ‘密胺餐具’, ‘亚克力板’, ‘PVC管’, ‘插座’, ‘化妆品塑料瓶’, ‘篮球’, ‘足球’, ‘KT板’, ‘食品塑料盒’, ‘食用油桶’, ‘塑料杯’, ‘塑料盆’, ‘一次性餐盒’, ‘废弃衣服’, ‘鞋’, ‘碎布’, ‘书包’, ‘床上用品’, ‘棉被’, ‘丝绸手绢’, ‘枕头’, ‘毛绒玩具’, ‘皮带’, ‘电路板’, ‘充电宝’, ‘木制品’, ‘优盘’, ‘灯管灯泡’, ‘节能灯’, ‘二极管’, ‘纽扣电池’, ‘手机电池’, ‘镍镉电池’, ‘锂电池’, ‘蓄电池’, ‘胶卷’, ‘照片’, ‘指甲油瓶’, ‘X光片’, ‘农药瓶’, ‘杀虫剂及罐’, ‘蜡烛’, ‘墨盒’, ‘染发剂壳’, ‘消毒液瓶’, ‘油漆桶’, ‘药品包装’, ‘药瓶’, ‘废弃针管’, ‘输液管’, ‘口服液瓶’, ‘眼药水瓶’, ‘水银温度计’, ‘水银血压计’, ‘胶囊’, ‘药片’, ‘固体杀虫剂’, ‘甘蔗皮’, ‘坚果壳’, ‘橡皮泥’, ‘毛发’, ‘棉签’, ‘创可贴’, ‘口红’, ‘笔’, ‘纸巾’, ‘胶带’, ‘湿巾’, ‘水彩笔’, ‘打火机’, ‘防碎气泡膜’, ‘榴莲壳’, ‘睫毛膏’, ‘眼影’, ‘仓鼠浴沙’, ‘大骨棒’, ‘旧毛巾’, ‘竹制品’, ‘粉笔’, ‘一次性口罩’, ‘一次性手套’, ‘粉底液’, ‘灰土’, ‘尼龙制品’, ‘尿片’, ‘雨伞’, ‘带胶制品’, ‘牙膏皮’, ‘狗尿布’, ‘椰子壳’, ‘粉扑’, ‘破碗碟’, ‘陶瓷’, ‘卫生纸’, ‘烟头’, ‘假睫毛’, ‘猫砂’, ‘牙刷’, ‘玉米棒’]</p>
<h2 id="Read-annotations"><a href="#Read-annotations" class="headerlink" title="Read annotations"></a>Read annotations</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_labels[<span class="string">'annotations'</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">out:[&#123;&#39;area&#39;: 81909.20209190401,</span><br><span class="line">      &#39;iscrowd&#39;: 0,</span><br><span class="line">      &#39;image_id&#39;: 11003,</span><br><span class="line">      &#39;bbox&#39;: [636.08832, 305.77176, 298.5888, 274.32108000000005],</span><br><span class="line">      &#39;category_id&#39;: 2&#125;,</span><br><span class="line">     &#123;&#39;area&#39;: 105273.393928704,</span><br><span class="line">      &#39;iscrowd&#39;: 0,</span><br><span class="line">      &#39;image_id&#39;: 11004,</span><br><span class="line">      &#39;bbox&#39;: [804.4512, 420.56064, 306.46848, 343.5048],</span><br><span class="line">      &#39;category_id&#39;: 2&#125;,</span><br><span class="line">      ......</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(train_labels[<span class="string">'annotations'</span>])</span><br><span class="line"><span class="comment">#out:list</span></span><br></pre></td></tr></table></figure>

<p> As an example, let’s load an image and its annotation. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n = random.randint(<span class="number">1</span>, len(train_labels[<span class="string">'annotations'</span>])) <span class="comment"># select the random n-th image as example</span></span><br><span class="line"></span><br><span class="line">image_id = train_labels[<span class="string">'annotations'</span>][n][<span class="string">'image_id'</span>]</span><br><span class="line">category_id = train_labels[<span class="string">'annotations'</span>][n][<span class="string">'category_id'</span>]</span><br><span class="line">category_name = names[category_id - <span class="number">1</span>]  <span class="comment"># ←look here</span></span><br><span class="line"></span><br><span class="line">image = cv2.imread(<span class="string">'./dataset/resizedFullGarbageDataset/train_resized/'</span> + str(image_id) + <span class="string">'.jpg'</span>) <span class="comment">#load the pictures</span></span><br><span class="line"></span><br><span class="line">plt.imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB)) <span class="comment">#use cv2 to show the picture</span></span><br><span class="line">print(<span class="string">"Index:%d\nFilename:%d.jpg\nCategory:%d-%s"</span>%(n, image_id, category_id, category_name)) <span class="comment">#\n means changing to another row</span></span><br><span class="line"><span class="comment">#out:Index:47056</span></span><br><span class="line"><span class="comment">#    Filename:265768.jpg</span></span><br><span class="line"><span class="comment">#    Category:122-书包</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/03/22/8If1PA.png" alt="8If1PA.png"></p>
<p>Observe the distribution of classes.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">image_ids = []</span><br><span class="line">category_ids = []</span><br><span class="line">category_names = []</span><br><span class="line"><span class="keyword">for</span> label <span class="keyword">in</span> train_labels[<span class="string">'annotations'</span>]:</span><br><span class="line">    image_ids.append(label[<span class="string">'image_id'</span>]) <span class="comment">#add pictures to the list</span></span><br><span class="line">    category_ids.append(label[<span class="string">'category_id'</span>]) <span class="comment">#add category</span></span><br><span class="line">    category_names.append(names[label[<span class="string">'category_id'</span>] - <span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">plt.hist(category_ids, bins=len(names), density=<span class="number">0</span>)</span><br><span class="line">plt.xlim(<span class="number">1</span>, <span class="number">204</span>)</span><br><span class="line">plt.xlabel(<span class="string">"category_id"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"number"</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/03/22/8IfBPs.png" alt="8IfBPs.png"></p>
<h2 id="Convert-annotations-into-CSV-format"><a href="#Convert-annotations-into-CSV-format" class="headerlink" title="Convert annotations into CSV format"></a>Convert annotations into CSV format</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'./dataset/resizedFullGarbageDataset/train.csv'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">"id,label,name,filename\n"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(image_ids)):</span><br><span class="line">        f.write(<span class="string">"%s,%s,%s,%s.jpg\n"</span>%(str(image_ids[i]), str(category_ids[i]), names[category_ids[i]<span class="number">-1</span>], str(image_ids[i])))</span><br></pre></td></tr></table></figure>





<h1 id="05-2-Train-a-garbage-classifier"><a href="#05-2-Train-a-garbage-classifier" class="headerlink" title="05.2.Train a garbage classifier"></a>05.2.Train a garbage classifier</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import, division, print_function, unicode_literals</span><br><span class="line"></span><br><span class="line"><span class="comment"># TensorFlow and tf.keras</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.callbacks <span class="keyword">import</span> LearningRateScheduler</span><br><span class="line"></span><br><span class="line"><span class="comment"># Helper libraries</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'SimHei'</span>]  <span class="comment"># 用来正常显示中文标签</span></span><br><span class="line">plt.rcParams[<span class="string">'axes.unicode_minus'</span>] = <span class="literal">False</span>  <span class="comment"># 用来正常显示负号</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment"># ← a new package is needed to be install, use &gt; conda install pandas</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line">print(tf.__version__)</span><br></pre></td></tr></table></figure>

<h2 id="Import-dataset-and-preprocessing"><a href="#Import-dataset-and-preprocessing" class="headerlink" title="Import dataset and preprocessing"></a>Import dataset and preprocessing</h2><p>Because our dataset is a bit large, RAM may not be enough to directly load all images. We can use <code>flow_from_dataframe</code> to load our dataset. (click <a href="https://keras.io/preprocessing/image/" target="_blank" rel="noopener">here</a> to read more about this function)<br>First, load labels from our <code>.csv</code> file. We use <code>pandas.read_csv</code>, it loads csv file to <code>DataFrame</code> format.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df=pd.read_csv(<span class="string">"./dataset/resizedFullGarbageDataset/train.csv"</span>, encoding=<span class="string">'gbk'</span>, dtype=str)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th></th>
<th>id</th>
<th>label</th>
<th>name</th>
<th>filename</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>11003</td>
<td>2</td>
<td>核桃</td>
<td>11003.jpg</td>
</tr>
<tr>
<td>1</td>
<td>11004</td>
<td>2</td>
<td>核桃</td>
<td>11004.jpg</td>
</tr>
<tr>
<td>2</td>
<td>11005</td>
<td>2</td>
<td>核桃</td>
<td>11005.jpg</td>
</tr>
<tr>
<td>3</td>
<td>11006</td>
<td>2</td>
<td>核桃</td>
<td>11006.jpg</td>
</tr>
<tr>
<td>…</td>
<td>……</td>
<td>……</td>
<td>……</td>
<td>……</td>
</tr>
</tbody></table>
<p> Then, use <code>keras.preprocessing.image.ImageDataGenerator</code> to load trainset.<br>‘catagories’ in the JSON file says, the dataset contains 202 classes, but actually it has only 198 classes. To avoid confusing <code>df[&#39;label&#39;]</code> with index of classifier output, we use <code>df[&#39;name&#39;]</code> as input.<br>75% of images are set as trainset, while 25% of images are set as testset. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">batch_size = <span class="number">32</span></span><br><span class="line">sizeX, sizeY = <span class="number">112</span>, <span class="number">112</span></span><br><span class="line"></span><br><span class="line">datagen=ImageDataGenerator(rescale=<span class="number">1.</span>/<span class="number">255</span>, validation_split=<span class="number">0.25</span>)</span><br><span class="line"><span class="comment">#trainset:</span></span><br><span class="line">trainset = datagen.flow_from_dataframe(dataframe=df, directory=<span class="string">'./dataset/resizedFullGarbageDataset/train_resized'</span>, <span class="comment">#the position of file</span></span><br><span class="line">                                       x_col=<span class="string">'filename'</span>, y_col=<span class="string">'name'</span>, class_mode=<span class="string">'categorical'</span>, target_size=(sizeX,sizeY),</span><br><span class="line">                                       batch_size=batch_size, shuffle=<span class="literal">True</span>, seed=<span class="number">0Xabc123</span>, subset=<span class="string">'training'</span>)</span><br><span class="line"><span class="comment">#testset:</span></span><br><span class="line">testset = datagen.flow_from_dataframe(dataframe=df, directory=<span class="string">'./dataset/resizedFullGarbageDataset/train_resized'</span>,</span><br><span class="line">                                      x_col=<span class="string">'filename'</span>, y_col=<span class="string">'name'</span>, class_mode=<span class="string">'categorical'</span>, target_size=(sizeX,sizeY),</span><br><span class="line">                                      batch_size=batch_size, shuffle=<span class="literal">True</span>, seed=<span class="number">0Xabc123</span>, subset=<span class="string">'validation'</span>)</span><br></pre></td></tr></table></figure>

<p> Correspondingly, we can use <code>.class_indices</code> to see the relationship between <code>name</code> and <code>index</code> before one-hot encoding. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">names = trainset.class_indices</span><br><span class="line">names</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#39;KT板&#39;: 0,</span><br><span class="line"> &#39;PVC管&#39;: 1,</span><br><span class="line"> &#39;X光片&#39;: 2,</span><br><span class="line"> &#39;一次性口罩&#39;: 3,</span><br><span class="line"> &#39;一次性塑料餐盒餐具&#39;: 4,</span><br><span class="line"> &#39;一次性手套&#39;: 5,</span><br><span class="line"> ......</span><br></pre></td></tr></table></figure>

<p> We can define a function to get <code>name</code> through <code>index</code>. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getname</span><span class="params">(index)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> list(names)[index]</span><br></pre></td></tr></table></figure>

<p> <code>trainset[i]</code> has two parts. <code>trainset[i][0]</code> is the i-th batch of image, while <code>trainset[i][1]</code> is one-hot encodings which represents classes. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">16</span>,<span class="number">6</span>))</span><br><span class="line">n = random.randint(<span class="number">0</span>,<span class="number">1874</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    plt.subplot(<span class="number">1</span>,<span class="number">4</span>,i+<span class="number">1</span>)</span><br><span class="line">    plt.imshow(trainset[n][<span class="number">0</span>][i]) <span class="comment">#plot the pictures</span></span><br><span class="line">    index = np.argmax(trainset[n][<span class="number">1</span>][i])</span><br><span class="line">    plt.xlabel(str(index) + <span class="string">':'</span> + getname(index)) <span class="comment">#show the category</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/03/23/87h9DP.png" alt="87h9DP.png"></p>
<h2 id="Describe-our-model"><a href="#Describe-our-model" class="headerlink" title="Describe our model"></a>Describe our model</h2><p>As an example, we describe the following model.<br><em>(This example may not have good performance.)</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">input_shape = (sizeX, sizeY, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    keras.layers.Conv2D(<span class="number">16</span>, kernel_size=(<span class="number">5</span>, <span class="number">5</span>),</span><br><span class="line">                 activation=<span class="string">'relu'</span>,</span><br><span class="line">                 input_shape=input_shape),</span><br><span class="line">    keras.layers.MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line">    keras.layers.Conv2D(<span class="number">32</span>, kernel_size=(<span class="number">5</span>, <span class="number">5</span>), activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line">    keras.layers.Flatten(),</span><br><span class="line">    keras.layers.Dense(<span class="number">120</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.Dense(<span class="number">84</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.Dense(<span class="number">198</span>, activation=<span class="string">'softmax'</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model.compile(loss=keras.losses.categorical_crossentropy,</span><br><span class="line">              optimizer=keras.optimizers.Adam(),</span><br><span class="line">              metrics=[<span class="string">"accuracy"</span>])</span><br></pre></td></tr></table></figure>

<h2 id="Start-learning"><a href="#Start-learning" class="headerlink" title="Start learning"></a>Start learning</h2><p> Because the dataset is large, <em>it may take a <strong>very long</strong> time.</em> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">STEP_SIZE_TRAIN=trainset.n//trainset.batch_size</span><br><span class="line">STEP_SIZE_VALID=testset.n//testset.batch_size</span><br><span class="line">print(STEP_SIZE_TRAIN, STEP_SIZE_VALID)</span><br><span class="line"></span><br><span class="line">model.fit_generator(generator=trainset,</span><br><span class="line">                    steps_per_epoch=STEP_SIZE_TRAIN,</span><br><span class="line">                    validation_data=testset,</span><br><span class="line">                    validation_steps=STEP_SIZE_VALID,</span><br><span class="line">                    epochs=<span class="number">1</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="Evaluate-the-model"><a href="#Evaluate-the-model" class="headerlink" title="Evaluate the model"></a>Evaluate the model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.evaluate_generator(testset,verbose=<span class="number">1</span>) <span class="comment">#predict</span></span><br></pre></td></tr></table></figure>

<h2 id="Save-the-trained-model"><a href="#Save-the-trained-model" class="headerlink" title="Save the trained model"></a>Save the trained model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">modelname = <span class="string">'garbageExample0'</span></span><br><span class="line">model.save(<span class="string">'./TrainedModels/'</span> + modelname + <span class="string">'.h5'</span>)<span class="comment">#create the file and save it</span></span><br></pre></td></tr></table></figure>





<h1 id="05-3-Make-prediction-on-validationset"><a href="#05-3-Make-prediction-on-validationset" class="headerlink" title="05.3.Make prediction on validationset"></a>05.3.Make prediction on validationset</h1><p>from <strong>future</strong> import absolute_import, division, print_function, unicode_literals</p>
<h1 id="TensorFlow-and-tf-keras"><a href="#TensorFlow-and-tf-keras" class="headerlink" title="TensorFlow and tf.keras"></a>TensorFlow and tf.keras</h1><p>import tensorflow as tf<br>from tensorflow import keras<br>from tensorflow.keras import backend as K<br>from tensorflow.keras.preprocessing.image import ImageDataGenerator<br>from tensorflow.keras.callbacks import LearningRateScheduler<br>from tensorflow.keras.preprocessing import image</p>
<h1 id="Helper-libraries"><a href="#Helper-libraries" class="headerlink" title="Helper libraries"></a>Helper libraries</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">plt.rcParams[&#39;font.sans-serif&#39;] &#x3D; [&#39;SimHei&#39;]  # 用来正常显示中文标签</span><br><span class="line">plt.rcParams[&#39;axes.unicode_minus&#39;] &#x3D; False  # 用来正常显示负号</span><br><span class="line">import random</span><br><span class="line">import pandas as pd # ← a new package is needed to be install, use &gt; conda install pandas</span><br><span class="line">import cv2</span><br><span class="line">import os</span><br><span class="line">import json</span><br></pre></td></tr></table></figure>

<h2 id="Load-trained-model"><a href="#Load-trained-model" class="headerlink" title="Load trained model"></a>Load trained model</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">modelname &#x3D; &#39;garbageExample0&#39;</span><br><span class="line">model &#x3D; keras.models.load_model(&#39;.&#x2F;trainedModels&#x2F;&#39; + modelname + &#39;.h5&#39;)</span><br></pre></td></tr></table></figure>

<h2 id="Import-validationset"><a href="#Import-validationset" class="headerlink" title="Import validationset"></a>Import validationset</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">valiset_path = <span class="string">'./dataset/resizedFullGarbageDataset/val_resized'</span></span><br><span class="line">valiset_filenames = os.listdir(valiset_path)</span><br><span class="line">len(valiset_filenames)</span><br><span class="line"><span class="comment">#out:10000</span></span><br></pre></td></tr></table></figure>

<h2 id="Define-getname-function"><a href="#Define-getname-function" class="headerlink" title="Define getname() function"></a>Define <code>getname()</code> function</h2><p>The names is in the order generated by <code>flow_from_dataframe</code> before training.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">names = &#123;<span class="string">'KT板'</span>: <span class="number">0</span>, <span class="string">'PVC管'</span>: <span class="number">1</span>, <span class="string">'X光片'</span>: <span class="number">2</span>, <span class="string">'一次性口罩'</span>: <span class="number">3</span>, <span class="string">'一次性塑料餐盒餐具'</span>: <span class="number">4</span>, <span class="string">'一次性手套'</span>: <span class="number">5</span>,</span><br><span class="line">         <span class="string">'一次性餐盒'</span>: <span class="number">6</span>, <span class="string">'丝绸手绢'</span>: <span class="number">7</span>, <span class="string">'中药材'</span>: <span class="number">8</span>, <span class="string">'中药渣'</span>: <span class="number">9</span>, <span class="string">'书包'</span>: <span class="number">10</span>,</span><br><span class="line">         <span class="string">'二极管'</span>: <span class="number">11</span>, <span class="string">'五谷杂粮'</span>: <span class="number">12</span>, <span class="string">'亚克力板'</span>: <span class="number">13</span>, <span class="string">'仓鼠浴沙'</span>: <span class="number">14</span>, <span class="string">'优盘'</span>: <span class="number">15</span>,</span><br><span class="line">          <span class="string">'保温杯'</span>: <span class="number">16</span>, <span class="string">'信封'</span>: <span class="number">17</span>, <span class="string">'假睫毛'</span>: <span class="number">18</span>, <span class="string">'充电宝'</span>: <span class="number">19</span>, <span class="string">'农药瓶'</span>: <span class="number">20</span>,</span><br><span class="line">          <span class="string">'冲泡饮料粉'</span>: <span class="number">21</span>, <span class="string">'创可贴'</span>: <span class="number">22</span>, <span class="string">'利乐包'</span>: <span class="number">23</span>, <span class="string">'动物内脏'</span>: <span class="number">24</span>, <span class="string">'动物蹄'</span>: <span class="number">25</span>,</span><br><span class="line">          <span class="string">'勺子'</span>: <span class="number">26</span>, <span class="string">'化妆品塑料瓶'</span>: <span class="number">27</span>, <span class="string">'化妆品玻璃瓶'</span>: <span class="number">28</span>, <span class="string">'卫生纸'</span>: <span class="number">29</span>, <span class="string">'叉子'</span>: <span class="number">30</span>,</span><br><span class="line">          <span class="string">'口服液瓶'</span>: <span class="number">31</span>, <span class="string">'口红'</span>: <span class="number">32</span>, <span class="string">'吸铁石'</span>: <span class="number">33</span>, <span class="string">'咖啡渣'</span>: <span class="number">34</span>, <span class="string">'固体杀虫剂'</span>: <span class="number">35</span>,</span><br><span class="line">          <span class="string">'图书期刊'</span>: <span class="number">36</span>, <span class="string">'坚果壳'</span>: <span class="number">37</span>, <span class="string">'塑料包装'</span>: <span class="number">38</span>, <span class="string">'塑料杯'</span>: <span class="number">39</span>, <span class="string">'塑料泡沫'</span>: <span class="number">40</span>,</span><br><span class="line">          <span class="string">'塑料玩具'</span>: <span class="number">41</span>, <span class="string">'塑料盆'</span>: <span class="number">42</span>, <span class="string">'塑料衣架'</span>: <span class="number">43</span>, <span class="string">'墨盒'</span>: <span class="number">44</span>, <span class="string">'大骨棒'</span>: <span class="number">45</span>,</span><br><span class="line">         <span class="string">'奶酪'</span>: <span class="number">46</span>, <span class="string">'宠物饲料'</span>: <span class="number">47</span>, <span class="string">'密胺餐具'</span>: <span class="number">48</span>, <span class="string">'小龙虾'</span>: <span class="number">49</span>, <span class="string">'尼龙制品'</span>: <span class="number">50</span>,</span><br><span class="line">         <span class="string">'尿片'</span>: <span class="number">51</span>, <span class="string">'带胶制品'</span>: <span class="number">52</span>, <span class="string">'干果'</span>: <span class="number">53</span>, <span class="string">'广告单'</span>: <span class="number">54</span>, <span class="string">'床上用品'</span>: <span class="number">55</span>,</span><br><span class="line">         <span class="string">'废弃衣服'</span>: <span class="number">56</span>, <span class="string">'废弃针管'</span>: <span class="number">57</span>, <span class="string">'快递纸袋'</span>: <span class="number">58</span>, <span class="string">'手机电池'</span>: <span class="number">59</span>, <span class="string">'打印纸'</span>: <span class="number">60</span>,</span><br><span class="line">         <span class="string">'报纸'</span>: <span class="number">61</span>, <span class="string">'指甲油瓶'</span>: <span class="number">62</span>, <span class="string">'排骨-小肋排'</span>: <span class="number">63</span>, <span class="string">'插座'</span>: <span class="number">64</span>, <span class="string">'数据线'</span>: <span class="number">65</span>,</span><br><span class="line">         <span class="string">'日历'</span>: <span class="number">66</span>, <span class="string">'旧毛巾'</span>: <span class="number">67</span>, <span class="string">'易拉罐'</span>: <span class="number">68</span>, <span class="string">'木制品'</span>: <span class="number">69</span>, <span class="string">'杀虫剂及罐'</span>: <span class="number">70</span>,</span><br><span class="line">         <span class="string">'杂草'</span>: <span class="number">71</span>, <span class="string">'枕头'</span>: <span class="number">72</span>, <span class="string">'枣核'</span>: <span class="number">73</span>, <span class="string">'染发剂壳'</span>: <span class="number">74</span>, <span class="string">'柚子皮'</span>: <span class="number">75</span>,</span><br><span class="line">         <span class="string">'柿子皮'</span>: <span class="number">76</span>, <span class="string">'树叶'</span>: <span class="number">77</span>, <span class="string">'核桃'</span>: <span class="number">78</span>, <span class="string">'桔子皮'</span>: <span class="number">79</span>, <span class="string">'棉签'</span>: <span class="number">80</span>,</span><br><span class="line">         <span class="string">'棉被'</span>: <span class="number">81</span>, <span class="string">'椰子壳'</span>: <span class="number">82</span>, <span class="string">'榴莲壳'</span>: <span class="number">83</span>, <span class="string">'橡皮泥'</span>: <span class="number">84</span>, <span class="string">'毛发'</span>: <span class="number">85</span>,</span><br><span class="line">         <span class="string">'毛绒玩具'</span>: <span class="number">86</span>, <span class="string">'毛豆壳'</span>: <span class="number">87</span>, <span class="string">'水银温度计'</span>: <span class="number">88</span>, <span class="string">'水银血压计'</span>: <span class="number">89</span>, <span class="string">'油漆桶'</span>: <span class="number">90</span>,</span><br><span class="line">         <span class="string">'消毒液瓶'</span>: <span class="number">91</span>, <span class="string">'湿巾'</span>: <span class="number">92</span>, <span class="string">'灯管灯泡'</span>: <span class="number">93</span>, <span class="string">'灰土'</span>: <span class="number">94</span>, <span class="string">'烟头'</span>: <span class="number">95</span>,</span><br><span class="line">         <span class="string">'烟盒'</span>: <span class="number">96</span>, <span class="string">'照片'</span>: <span class="number">97</span>, <span class="string">'牙刷'</span>: <span class="number">98</span>, <span class="string">'牙膏皮'</span>: <span class="number">99</span>, <span class="string">'狗尿布'</span>: <span class="number">100</span>,</span><br><span class="line">         <span class="string">'猫砂'</span>: <span class="number">101</span>, <span class="string">'玉米棒'</span>: <span class="number">102</span>, <span class="string">'玻璃制品'</span>: <span class="number">103</span>, <span class="string">'玻璃杯'</span>: <span class="number">104</span>, <span class="string">'瓜子壳'</span>: <span class="number">105</span>,</span><br><span class="line">         <span class="string">'甘蔗皮'</span>: <span class="number">106</span>, <span class="string">'电线'</span>: <span class="number">107</span>, <span class="string">'电路板'</span>: <span class="number">108</span>, <span class="string">'皮带'</span>: <span class="number">109</span>, <span class="string">'眼影'</span>: <span class="number">110</span>,</span><br><span class="line">         <span class="string">'眼药水瓶'</span>: <span class="number">111</span>, <span class="string">'睫毛膏'</span>: <span class="number">112</span>, <span class="string">'矿泉水瓶'</span>: <span class="number">113</span>, <span class="string">'破碗碟'</span>: <span class="number">114</span>, <span class="string">'硬塑料'</span>: <span class="number">115</span>,</span><br><span class="line">         <span class="string">'碎玻璃片'</span>: <span class="number">116</span>, <span class="string">'窗玻璃'</span>: <span class="number">117</span>, <span class="string">'竹制品'</span>: <span class="number">118</span>, <span class="string">'笔'</span>: <span class="number">119</span>, <span class="string">'篮球'</span>: <span class="number">120</span>,</span><br><span class="line">         <span class="string">'粉底液'</span>: <span class="number">121</span>, <span class="string">'粉扑'</span>: <span class="number">122</span>, <span class="string">'粉笔'</span>: <span class="number">123</span>, <span class="string">'粽子'</span>: <span class="number">124</span>, <span class="string">'糕饼'</span>: <span class="number">125</span>,</span><br><span class="line">         <span class="string">'糖果'</span>: <span class="number">126</span>, <span class="string">'纸巾'</span>: <span class="number">127</span>, <span class="string">'纽扣电池'</span>: <span class="number">128</span>, <span class="string">'绿植'</span>: <span class="number">129</span>, <span class="string">'罐头'</span>: <span class="number">130</span>,</span><br><span class="line">         <span class="string">'罐头盒'</span>: <span class="number">131</span>, <span class="string">'肉干'</span>: <span class="number">132</span>, <span class="string">'肉类'</span>: <span class="number">133</span>, <span class="string">'胶卷'</span>: <span class="number">134</span>, <span class="string">'胶囊'</span>: <span class="number">135</span>,</span><br><span class="line">         <span class="string">'胶带'</span>: <span class="number">136</span>, <span class="string">'节能灯'</span>: <span class="number">137</span>, <span class="string">'芒果皮'</span>: <span class="number">138</span>, <span class="string">'花生壳'</span>: <span class="number">139</span>, <span class="string">'苹果核'</span>: <span class="number">140</span>,</span><br><span class="line">         <span class="string">'苹果皮'</span>: <span class="number">141</span>, <span class="string">'茶叶渣'</span>: <span class="number">142</span>, <span class="string">'荔枝壳'</span>: <span class="number">143</span>, <span class="string">'药品包装'</span>: <span class="number">144</span>, <span class="string">'药片'</span>: <span class="number">145</span>,</span><br><span class="line">         <span class="string">'药瓶'</span>: <span class="number">146</span>, <span class="string">'菌菇类'</span>: <span class="number">147</span>, <span class="string">'菜刀'</span>: <span class="number">148</span>, <span class="string">'菜叶'</span>: <span class="number">149</span>, <span class="string">'菜根'</span>: <span class="number">150</span>,</span><br><span class="line">         <span class="string">'蓄电池'</span>: <span class="number">151</span>, <span class="string">'薯片'</span>: <span class="number">152</span>, <span class="string">'虾'</span>: <span class="number">153</span>, <span class="string">'蛋壳'</span>: <span class="number">154</span>, <span class="string">'蜜饯'</span>: <span class="number">155</span>,</span><br><span class="line">         <span class="string">'螺蛳'</span>: <span class="number">156</span>, <span class="string">'蟹壳'</span>: <span class="number">157</span>, <span class="string">'西瓜子'</span>: <span class="number">158</span>, <span class="string">'西瓜皮'</span>: <span class="number">159</span>, <span class="string">'话梅核'</span>: <span class="number">160</span>,</span><br><span class="line">         <span class="string">'调料'</span>: <span class="number">161</span>, <span class="string">'谷类及加工物'</span>: <span class="number">162</span>, <span class="string">'豆类'</span>: <span class="number">163</span>, <span class="string">'贝类去硬壳'</span>: <span class="number">164</span>, <span class="string">'购物纸袋'</span>: <span class="number">165</span>,</span><br><span class="line">         <span class="string">'足球'</span>: <span class="number">166</span>, <span class="string">'输液管'</span>: <span class="number">167</span>, <span class="string">'酱料'</span>: <span class="number">168</span>, <span class="string">'金属制品'</span>: <span class="number">169</span>, <span class="string">'金属工具'</span>: <span class="number">170</span>,</span><br><span class="line">         <span class="string">'金属瓶罐'</span>: <span class="number">171</span>, <span class="string">'铝制品'</span>: <span class="number">172</span>, <span class="string">'锂电池'</span>: <span class="number">173</span>, <span class="string">'锅'</span>: <span class="number">174</span>, <span class="string">'镍镉电池'</span>: <span class="number">175</span>,</span><br><span class="line">         <span class="string">'镜子'</span>: <span class="number">176</span>, <span class="string">'防碎气泡膜'</span>: <span class="number">177</span>, <span class="string">'陶瓷'</span>: <span class="number">178</span>, <span class="string">'雨伞'</span>: <span class="number">179</span>, <span class="string">'面包'</span>: <span class="number">180</span>,</span><br><span class="line">         <span class="string">'面食'</span>: <span class="number">181</span>, <span class="string">'鞋'</span>: <span class="number">182</span>, <span class="string">'鞋盒'</span>: <span class="number">183</span>, <span class="string">'风干食品'</span>: <span class="number">184</span>, <span class="string">'食品及日用品玻璃瓶罐'</span>: <span class="number">185</span>,</span><br><span class="line">         <span class="string">'食品塑料盒'</span>: <span class="number">186</span>, <span class="string">'食品外包装盒'</span>: <span class="number">187</span>, <span class="string">'食用油桶'</span>: <span class="number">188</span>, <span class="string">'饼干'</span>: <span class="number">189</span>, <span class="string">'香蕉皮'</span>: <span class="number">190</span>,</span><br><span class="line">         <span class="string">'鱼'</span>: <span class="number">191</span>, <span class="string">'鱼骨头'</span>: <span class="number">192</span>, <span class="string">'鱼鳞'</span>: <span class="number">193</span>, <span class="string">'鲜花'</span>: <span class="number">194</span>, <span class="string">'鸡'</span>: <span class="number">195</span>,</span><br><span class="line">         <span class="string">'鸡骨头'</span>: <span class="number">196</span>, <span class="string">'鸭'</span>: <span class="number">197</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getname</span><span class="params">(index)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> list(names)[index]</span><br></pre></td></tr></table></figure>

<h2 id="Define-get-category-id-function"><a href="#Define-get-category-id-function" class="headerlink" title="Define get_category_id() function"></a>Define <code>get_category_id()</code> function</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'./dataset/resizedFullGarbageDataset/train.json'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    train_labels = json.load(f)</span><br><span class="line">names_dict = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> label <span class="keyword">in</span> train_labels[<span class="string">'categories'</span>]:</span><br><span class="line">    names_dict.update(&#123;label[<span class="string">'name'</span>] : label[<span class="string">'id'</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_category_id</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> names_dict[name]</span><br></pre></td></tr></table></figure>

<h2 id="Make-prediction-and-post-process"><a href="#Make-prediction-and-post-process" class="headerlink" title="Make prediction and post process"></a>Make prediction and post process</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">results_name = []</span><br><span class="line">results_label = [] <span class="comment"># category_id</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(valiset_filenames)):</span><br><span class="line">    image_path = valiset_path + <span class="string">'/'</span> + valiset_filenames[i]</span><br><span class="line">    img = image.load_img(image_path, target_size=(<span class="number">112</span>, <span class="number">112</span>))</span><br><span class="line">    x = image.img_to_array(img)</span><br><span class="line">    x = np.expand_dims(x, axis=<span class="number">0</span>) /<span class="number">255</span></span><br><span class="line"></span><br><span class="line">    pred = model.predict(x)</span><br><span class="line">    </span><br><span class="line">    index = np.argmax(pred)</span><br><span class="line">    result_name = getname(index)</span><br><span class="line">    result_label = get_category_id(result_name)</span><br><span class="line">    </span><br><span class="line">    results_name.append(result_name)</span><br><span class="line">    results_label.append(result_label)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>((i+<span class="number">1</span>) % <span class="number">100</span> == <span class="number">0</span>):</span><br><span class="line">        print(<span class="string">"finished %d predictions"</span>%(i+<span class="number">1</span>)) <span class="comment">#to show the process</span></span><br></pre></td></tr></table></figure>

<h2 id="Observe-random-20-images"><a href="#Observe-random-20-images" class="headerlink" title="Observe random 20 images"></a>Observe random 20 images</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">randNums = random.sample(range(<span class="number">0</span>, len(valiset_filenames)), <span class="number">20</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">18</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">20</span>):</span><br><span class="line">    filename = valiset_filenames[randNums[i]]</span><br><span class="line">    image_path = valiset_path + <span class="string">'/'</span> + filename</span><br><span class="line">    img = image.load_img(image_path, target_size=(<span class="number">112</span>, <span class="number">112</span>))</span><br><span class="line">    x = image.img_to_array(img)</span><br><span class="line">    x = np.expand_dims(x, axis=<span class="number">0</span>) /<span class="number">255</span></span><br><span class="line">    pred = model.predict(x)</span><br><span class="line">    index = np.argmax(pred)</span><br><span class="line">    result_name = getname(index)</span><br><span class="line">    result_label = get_category_id(result_name)</span><br><span class="line">    </span><br><span class="line">    plt.subplot(<span class="number">4</span>,<span class="number">5</span>,i+<span class="number">1</span>)</span><br><span class="line">    plt.imshow(x[<span class="number">0</span>])</span><br><span class="line">    plt.title(filename)</span><br><span class="line">    plt.xlabel(<span class="string">"Prediction: %d-%s"</span>%(result_label, result_name))</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/03/23/87OS7d.png" alt="87OS7d.png"></p>
<h2 id="Save-results"><a href="#Save-results" class="headerlink" title="Save results"></a>Save results</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">resultName = <span class="string">'test0'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./PredictResults/'</span> + resultName + <span class="string">'.csv'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">"id,label\n"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(valiset_filenames)):</span><br><span class="line">        vali_id = str(valiset_filenames[i]).replace(<span class="string">'.jpg'</span>,<span class="string">''</span>)</span><br><span class="line">        f.write(<span class="string">"%s,%s\n"</span>%(vali_id, str(results_label[i])))</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B5/" data-id="ckbw9eiqn001i34ur373665xp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Competition/" rel="tag">Competition</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-有关海华AI比赛4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B4/" class="article-date">
  <time datetime="2020-03-23T11:55:50.000Z" itemprop="datePublished">2020-03-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B5%B7%E5%8D%8EAI-competition/">海华AI competition</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B4/">有关海华AI比赛4</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="CNN-based-Handwritten-Digit-Recognition"><a href="#CNN-based-Handwritten-Digit-Recognition" class="headerlink" title="CNN-based Handwritten Digit Recognition"></a>CNN-based Handwritten Digit Recognition</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import, division, print_function, unicode_literals</span><br><span class="line"></span><br><span class="line"><span class="comment"># TensorFlow and tf.keras</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"></span><br><span class="line"><span class="comment"># Helper libraries</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">print(tf.__version__)</span><br></pre></td></tr></table></figure>

<h2 id="Import-MNIST-dataset"><a href="#Import-MNIST-dataset" class="headerlink" title="Import MNIST dataset"></a>Import MNIST dataset</h2><p> This guide uses the <a href="http://yann.lecun.com/exdb/mnist/" target="_blank" rel="noopener">MNIST</a> dataset which contains 70,000 grayscale images in 10 categories. MNIST  stands for Mixed National Institute of Standards and Technology  database.<br>The MNIST dataset is often used as the “Hello, World” of  machine learning programs for computer vision. It contains images of  handwritten digits (0, 1, 2, etc.).<br>Here, 60,000 images are used to  train the network and 10,000 images to evaluate how accurately the  network learned to classify images. You can access MNIST directly from  TensorFlow. Import and load MNIST data directly from TensorFlow: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mnist = keras.datasets.mnist</span><br><span class="line"></span><br><span class="line">(train_images, train_labels), (test_images, test_labels) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># grayscale image has only 1 channal</span></span><br><span class="line"><span class="keyword">if</span> K.image_data_format() == <span class="string">'channels_first'</span>:</span><br><span class="line">    train_images = train_images.reshape(train_images.shape[<span class="number">0</span>], <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line">    test_images = test_images.reshape(test_images.shape[<span class="number">0</span>], <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line">    input_shape = (<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    train_images = train_images.reshape(train_images.shape[<span class="number">0</span>], <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    test_images = test_images.reshape(test_images.shape[<span class="number">0</span>], <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    input_shape = (<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Explore-the-data"><a href="#Explore-the-data" class="headerlink" title="Explore the data"></a>Explore the data</h2><p> Let’s explore the format of the dataset before training the model. The  following shows there are 60,000 images in the training set, with each  image represented as 28 x 28 pixels: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">train_images.shape</span><br><span class="line"><span class="comment">#out:(60000, 28, 28, 1) #the shape of the trainset</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Likewise, there are 60,000 labels in the training set:</span></span><br><span class="line">len(train_labels)</span><br><span class="line"><span class="comment">#out:60000</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Each label is an integer between 0 and 9:</span></span><br><span class="line">train_labels</span><br><span class="line"><span class="comment">#out:array([5, 0, 4, ..., 5, 6, 8], dtype=uint8)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Each label is an integer between 0 and 9:</span></span><br><span class="line">test_images.shape</span><br><span class="line"><span class="comment">#out:(10000, 28, 28, 1)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#And the test set contains 10,000 images labels:</span></span><br><span class="line">len(test_labels)</span><br><span class="line"><span class="comment">#out:10000</span></span><br></pre></td></tr></table></figure>

<h2 id="Preprocess-the-data"><a href="#Preprocess-the-data" class="headerlink" title="Preprocess the data"></a>Preprocess the data</h2><p>The data must be preprocessed before training the network. If you  inspect the first image in the training set, you will see that the pixel values fall in the range of 0 to 255:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plt.figure()</span><br><span class="line">plt.imshow(train_images[<span class="number">0</span>,:,:,<span class="number">0</span>])<span class="comment">#choose the first one in the set</span></span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.grid(<span class="literal">False</span>)<span class="comment">#no grid line #plt.grid(linestyle=":", color="r")</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p> <img src="https://s1.ax1x.com/2020/03/12/8VH5Eq.png" alt="8VH5Eq.png"></p>
<p>Scale these values to a range of 0 to 1 before feeding them to the  neural network model. To do so, divide the values by 255. It’s important that the <em>training set</em> and the <em>testing set</em> be preprocessed in the same way.<br>In addition, encode labels using one-hot encoding. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">train_images_normed = train_images / <span class="number">255.0</span> <span class="comment">#make the value between 1 and 0</span></span><br><span class="line"></span><br><span class="line">test_images_normed = test_images / <span class="number">255.0</span></span><br><span class="line"></span><br><span class="line">train_labels_onehot = keras.utils.to_categorical(train_labels, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">test_labels_onehot = keras.utils.to_categorical(test_labels, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<p> To verify that the data is in the correct format and that you’re ready  to build and train the network, let’s display the first 25 images from  the <em>training set</em> and display the class name below each image. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">10</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">25</span>): <span class="comment">#choose 25 sample and put them in 5x5 graph</span></span><br><span class="line">    plt.subplot(<span class="number">5</span>,<span class="number">5</span>,i+<span class="number">1</span>)</span><br><span class="line">    plt.xticks([])</span><br><span class="line">    plt.yticks([])</span><br><span class="line">    plt.grid(<span class="literal">False</span>)</span><br><span class="line">    plt.imshow(train_images[i,:,:,<span class="number">0</span>], cmap=plt.cm.binary)</span><br><span class="line">    plt.xlabel(train_labels[i])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/03/12/8VbS56.png" alt="8VbS56.png"></p>
<h2 id="Build-the-model"><a href="#Build-the-model" class="headerlink" title="Build the model"></a>Build the model</h2><p>Building the neural network requires configuring the layers of the model, then compiling the model.<br>This example is <a href="http://yann.lecun.com/exdb/lenet/" target="_blank" rel="noopener">LeNet-5</a>, you can modify the model as you like.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">model = keras.Sequential([</span><br><span class="line">    keras.layers.Conv2D(<span class="number">6</span>, kernel_size=(<span class="number">5</span>, <span class="number">5</span>),</span><br><span class="line">                 activation=<span class="string">'relu'</span>,</span><br><span class="line">                 input_shape=input_shape),</span><br><span class="line">    keras.layers.MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line">    keras.layers.Conv2D(<span class="number">16</span>, kernel_size=(<span class="number">5</span>, <span class="number">5</span>), activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line">    keras.layers.Flatten(),</span><br><span class="line">    keras.layers.Dense(<span class="number">120</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.Dense(<span class="number">84</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">    keras.layers.Dense(<span class="number">10</span>, activation=<span class="string">'softmax'</span>)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p> Observe the summary. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.summary()</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/03/12/8Vb8qs.png" alt="8Vb8qs.png"></p>
<p> Define the process you train the model. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">model.compile(loss=keras.losses.categorical_crossentropy,</span><br><span class="line">              optimizer=keras.optimizers.Adam(),</span><br><span class="line">              metrics=[<span class="string">'accuracy'</span>])</span><br></pre></td></tr></table></figure>

<h2 id="Train-the-model"><a href="#Train-the-model" class="headerlink" title="Train the model"></a>Train the model</h2><h3 id="Feed-the-model"><a href="#Feed-the-model" class="headerlink" title="Feed the model"></a>Feed the model</h3><p>To start training,  call the <code>model.fit</code> method—so called because it “fits” the model to the training data:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">model.fit(train_images_normed, train_labels_onehot, batch_size=<span class="number">100</span>, epochs=<span class="number">6</span>)</span><br><span class="line"><span class="comment"># It may need more than one minute</span></span><br></pre></td></tr></table></figure>

<p>As the model trains, the loss and accuracy metrics are displayed. </p>
<h3 id="Evaluate-accuracy"><a href="#Evaluate-accuracy" class="headerlink" title="Evaluate accuracy"></a>Evaluate accuracy</h3><p>Next, compare how the model performs on the test dataset:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test_loss, test_acc = model.evaluate(test_images_normed, test_labels_onehot, verbose=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'\nTest accuracy:'</span>, test_acc)Make predictions</span><br></pre></td></tr></table></figure>

<h3 id="Make-predictions"><a href="#Make-predictions" class="headerlink" title="Make predictions"></a>Make predictions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">predictions = model.predict(test_images_normed)</span><br></pre></td></tr></table></figure>

<p> Here, the model has predicted the label for each image in the testing set. Let’s take a look at the first prediction: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">predictions[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p> A prediction is an array of 10 numbers. They represent the model’s  “confidence” that the image corresponds to each of the 10 different  articles of clothing. You can see which label has the highest confidence value: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.argmax(predictions[<span class="number">0</span>])</span><br><span class="line"><span class="comment">#out:7</span></span><br></pre></td></tr></table></figure>

<p> So, the model is most confident that this image is 7. Examining the test label shows that this classification is correct: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test_labels[<span class="number">0</span>]</span><br><span class="line"><span class="comment">#out:7</span></span><br></pre></td></tr></table></figure>

<p> Graph this to look at the full set of 10 class predictions. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_image</span><span class="params">(i, predictions_array, true_label, img)</span>:</span></span><br><span class="line">    predictions_array, true_label, img = predictions_array, true_label[i], img[i,:,:,<span class="number">0</span>]</span><br><span class="line">    plt.grid(<span class="literal">False</span>)</span><br><span class="line">    plt.xticks([])</span><br><span class="line">    plt.yticks([])</span><br><span class="line"></span><br><span class="line">    plt.imshow(img, cmap=plt.cm.binary)</span><br><span class="line"></span><br><span class="line">    predicted_label = np.argmax(predictions_array)</span><br><span class="line">    <span class="keyword">if</span> predicted_label == true_label:</span><br><span class="line">        color = <span class="string">'blue'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        color = <span class="string">'red'</span></span><br><span class="line"></span><br><span class="line">    plt.xlabel(<span class="string">"Pred:&#123;&#125; &#123;:2.0f&#125;% (GT:&#123;&#125;)"</span>.format(predicted_label,</span><br><span class="line">                                <span class="number">100</span>*np.max(predictions_array),</span><br><span class="line">                                true_label),</span><br><span class="line">                                color=color)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_value_array</span><span class="params">(i, predictions_array, true_label)</span>:</span></span><br><span class="line">    predictions_array, true_label = predictions_array, true_label[i]</span><br><span class="line">    plt.grid(<span class="literal">False</span>)</span><br><span class="line">    plt.xticks(range(<span class="number">10</span>))</span><br><span class="line">    plt.yticks([])</span><br><span class="line">    thisplot = plt.bar(range(<span class="number">10</span>), predictions_array, color=<span class="string">"#777777"</span>)</span><br><span class="line">    plt.ylim([<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">    predicted_label = np.argmax(predictions_array)</span><br><span class="line"></span><br><span class="line">    thisplot[predicted_label].set_color(<span class="string">'red'</span>)</span><br><span class="line">    thisplot[true_label].set_color(<span class="string">'blue'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Verify-predictions"><a href="#Verify-predictions" class="headerlink" title="Verify predictions"></a>Verify predictions</h3><p>With the model trained, you can use it to make predictions about some images.</p>
<p>Let’s look at the 0th image, predictions, and prediction array. Correct  prediction labels are blue and incorrect prediction labels are red. The  number gives the percentage (out of 100) for the predicted label.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line">plt.figure(figsize=(<span class="number">6</span>,<span class="number">3</span>))</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">plot_image(i, predictions[i], test_labels, test_images)<span class="comment">#show the original one</span></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">plot_value_array(i, predictions[i],  test_labels)<span class="comment">#show the predicted one</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/03/12/8VbRJK.png" alt="8VbRJK.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">12</span></span><br><span class="line">plt.figure(figsize=(<span class="number">6</span>,<span class="number">3</span>))</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">plot_image(i, predictions[i], test_labels, test_images)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">plot_value_array(i, predictions[i],  test_labels)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p> <img src="https://s1.ax1x.com/2020/03/12/8VbWRO.png" alt="8VbWRO.png"></p>
<p>Let’s plot several images with their predictions. Note that the model can be wrong even when very confident. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Plot random 25 test images, their predicted labels, and the true labels.</span></span><br><span class="line"><span class="comment"># Color correct predictions in blue and incorrect predictions in red.</span></span><br><span class="line">h = set()</span><br><span class="line"><span class="keyword">while</span>(len(h)&lt;<span class="number">25</span>):</span><br><span class="line">    h.add(random.randint(<span class="number">0</span>, <span class="number">9999</span>))</span><br><span class="line">    </span><br><span class="line">num_rows = <span class="number">5</span></span><br><span class="line">num_cols = <span class="number">3</span></span><br><span class="line">num_images = num_rows*num_cols</span><br><span class="line">plt.figure(figsize=(<span class="number">2</span>*<span class="number">2</span>*num_cols, <span class="number">2</span>*num_rows))</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> h:</span><br><span class="line">    plt.subplot(num_rows, <span class="number">2</span>*num_cols, <span class="number">2</span>*i+<span class="number">1</span>)</span><br><span class="line">    plot_image(p, predictions[p], test_labels, test_images)</span><br><span class="line">    plt.title(<span class="string">"Index:&#123;&#125;"</span>.format(p))</span><br><span class="line">    plt.subplot(num_rows, <span class="number">2</span>*num_cols, <span class="number">2</span>*i+<span class="number">2</span>)</span><br><span class="line">    plot_value_array(p, predictions[p], test_labels)</span><br><span class="line">    plt.title(<span class="string">"Scores"</span>)</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/03/12/8Vq9wn.png" alt="8Vq9wn.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B4/" data-id="ckbw9eiqm001g34ur6bo9bzir" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Competition/" rel="tag">Competition</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-有关海华AI比赛3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B3/" class="article-date">
  <time datetime="2020-03-23T11:49:42.000Z" itemprop="datePublished">2020-03-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B5%B7%E5%8D%8EAI-competition/">海华AI competition</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B3/">有关海华AI比赛3</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Neural-Network-based-Iris-Flower-Classification"><a href="#Neural-Network-based-Iris-Flower-Classification" class="headerlink" title="Neural-Network-based Iris Flower Classification"></a>Neural-Network-based Iris Flower Classification</h1><h2 id="0-Dataset-Description"><a href="#0-Dataset-Description" class="headerlink" title="0 Dataset Description"></a>0 Dataset Description</h2><p>Description Source: <a href="https://archive.ics.uci.edu/ml/datasets/Iris/" target="_blank" rel="noopener">https://archive.ics.uci.edu/ml/datasets/Iris/</a>  </p>
<p> <strong>Data Set Information:</strong><br>This is perhaps the best known database to be found in the pattern recognition literature. Fisher’s  paper is a classic in the field and is referenced frequently to this  day. (See Duda &amp; Hart, for example.) The data set contains 3 classes of 50 instances each, where each class refers to a type of iris plant.  One class is linearly separable from the other 2; the latter are NOT  linearly separable from each other.<br>Predicted attribute: class of iris plant.<br>This is an exceedingly simple domain.<br><strong>Attribute Information:</strong><br>column 1: sepal length in cm<br>column 2: sepal width in cm<br>column 3: petal length in cm<br>column 4: petal width in cm<br>column 5: class:<br>– Iris Setosa<br>– Iris Versicolour<br>– Iris Virginica   </p>
<h2 id="1-Observe-the-data"><a href="#1-Observe-the-data" class="headerlink" title="1 Observe the data"></a>1 Observe the data</h2><p>Load dataset from csv file.  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line"><span class="comment"># Declare list for storing dataset</span></span><br><span class="line">sepal_length = np.array([])</span><br><span class="line">sepal_width = np.array([])</span><br><span class="line">petal_length = np.array([])</span><br><span class="line">petal_width = np.array([])</span><br><span class="line">iris_class = np.array([])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load dataset from csv file</span></span><br><span class="line">reader = csv.reader(open(<span class="string">'./irisDataset.csv'</span>,<span class="string">'r'</span>))</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> reader:<span class="comment">#to create the dataframe</span></span><br><span class="line">    sepal_length = np.append(sepal_length, float(row[<span class="number">0</span>])) <span class="comment">#separate different values to different rows</span></span><br><span class="line">    sepal_width = np.append(sepal_width, float(row[<span class="number">1</span>]))</span><br><span class="line">    petal_length = np.append(petal_length, float(row[<span class="number">2</span>]))</span><br><span class="line">    petal_width = np.append(petal_width, float(row[<span class="number">3</span>]))</span><br><span class="line">    iris_class = np.append(iris_class, row[<span class="number">4</span>])</span><br></pre></td></tr></table></figure>

<p> Observe the format of data. (Take 10 examples randomly) </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">h =set()</span><br><span class="line"><span class="keyword">while</span>(len(h)&lt;<span class="number">10</span>):</span><br><span class="line">    h.add(random.randint(<span class="number">0</span>, <span class="number">149</span>))<span class="comment">#add the random number</span></span><br><span class="line">    <span class="comment">#choose 10 random example</span></span><br><span class="line">print(<span class="string">"ID \t SEPAL_LENGTH \t SEPAL_WIDTH \t PETAL_LENGTH \t PETAL_WIDTH \t|| CLASS"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> h:</span><br><span class="line">    print(<span class="string">"%d \t %.1f \t\t %.1f \t\t %.1f \t\t %.1f \t\t|| %s"</span> <span class="comment">#print the result</span></span><br><span class="line">          % (i, sepal_length[i], sepal_width[i], petal_length[i], petal_width[i], iris_class[i]))<span class="comment">#print the 10 example</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ID 	 SEPAL_LENGTH 	 SEPAL_WIDTH 	 PETAL_LENGTH 	 PETAL_WIDTH 	|| CLASS</span><br><span class="line">33 	    5.5 		    4.2 		    1.4 		    0.2 		|| setosa</span><br><span class="line">132     6.4 		    2.8 		    5.6 		    2.2 		|| virginica</span><br><span class="line">135     7.7 		    3.0 		    6.1 		    2.3 		|| virginica</span><br><span class="line">77 	    6.7 		    3.0 		    5.0 		    1.7 		|| versicolor</span><br><span class="line">14 	    5.8 		    4.0 		    1.2 		    0.2 		|| setosa</span><br><span class="line">15 	    5.7 		    4.4 		    1.5 		    0.4 		|| setosa</span><br><span class="line">146     6.3 		    2.5 		    5.0 		    1.9 		|| virginica</span><br><span class="line">54 	    6.5 		    2.8 		    4.6 		    1.5 		|| versicolor</span><br><span class="line">58 	    6.6 		    2.9 		    4.6 		    1.3 		|| versicolor</span><br><span class="line">31 	    5.4 		    3.4 		    1.5 		    0.4 		|| setosa</span><br></pre></td></tr></table></figure>

<p> Plot dataset. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#plot 3 kinds of iris, letting width y-axis, length x-axis, and plot the label(using sepal values)</span></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>) <span class="comment">#plot two background</span></span><br><span class="line">plt.scatter(sepal_length[iris_class==<span class="string">'setosa'</span>], sepal_width[iris_class==<span class="string">'setosa'</span>])</span><br><span class="line">plt.scatter(sepal_length[iris_class==<span class="string">'versicolor'</span>],sepal_width[iris_class==<span class="string">'versicolor'</span>])</span><br><span class="line">plt.scatter(sepal_length[iris_class==<span class="string">'virginica'</span>], sepal_width[iris_class==<span class="string">'virginica'</span>])</span><br><span class="line">plt.legend((<span class="string">"setosa"</span>,<span class="string">"versicolor"</span>,<span class="string">"virginica"</span>)) </span><br><span class="line">plt.xlabel(<span class="string">'sepal_length'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'sepal_width'</span>)</span><br><span class="line"><span class="comment">#plot 3 kinds of iris, letting width y-axis, length x-axis, and plot the label(using petal values)</span></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">plt.scatter(petal_length[iris_class==<span class="string">'setosa'</span>], petal_width[iris_class==<span class="string">'setosa'</span>])</span><br><span class="line">plt.scatter(petal_length[iris_class==<span class="string">'versicolor'</span>], petal_width[iris_class==<span class="string">'versicolor'</span>])</span><br><span class="line">plt.scatter(petal_length[iris_class==<span class="string">'virginica'</span>], petal_width[iris_class==<span class="string">'virginica'</span>])</span><br><span class="line">plt.legend((<span class="string">"setosa"</span>,<span class="string">"versicolor"</span>,<span class="string">"virginica"</span>))</span><br><span class="line">plt.xlabel(<span class="string">'petal_length'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'petal_width'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment">#sepal values can't separate them as gragh1 shows</span></span><br><span class="line"><span class="comment">#petal values can separate the as gragh2 shows,so we choose the petal values</span></span><br></pre></td></tr></table></figure>

<p><a href="https://imgchr.com/i/3zsonS" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2020/03/08/3zsonS.png" alt="3zsonS.png"></a></p>
<h2 id="2-Preprocess-dataset-and-Divide-dataset"><a href="#2-Preprocess-dataset-and-Divide-dataset" class="headerlink" title="2 Preprocess dataset and Divide dataset"></a>2 Preprocess dataset and Divide dataset</h2><p>Through observing the figure above, we can find that it’s easier to classify iris flowers by <code>petal_width</code> and <code>petal_length</code>. So, we can simplify the problem by ignoring <code>sepal_width</code> and <code>sepal_length</code>. (This kind of operation may decrease accuracy)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#put the petal values into array</span></span><br><span class="line">dataset_x = np.array((petal_length, petal_width)).T</span><br><span class="line"></span><br><span class="line"><span class="comment">#change differet kinds of iris into 0,1,2, which is easy to be recognized for computer</span></span><br><span class="line">dataset_y = np.zeros(iris_class.shape, dtype=int)</span><br><span class="line">dataset_y[iris_class == <span class="string">'setosa'</span>] = <span class="number">0</span></span><br><span class="line">dataset_y[iris_class == <span class="string">'versicolor'</span>] = <span class="number">1</span></span><br><span class="line">dataset_y[iris_class == <span class="string">'virginica'</span>] = <span class="number">2</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">num = len(iris_class)</span><br><span class="line">splitLine = int(<span class="number">0.8</span>*num)</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate a random list to select data randomly</span></span><br><span class="line">index = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, num)]</span><br><span class="line">random.shuffle(index) <span class="comment">#put them in random order</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># divide into trainset and testset</span></span><br><span class="line">train_x = dataset_x[index[<span class="number">0</span>:splitLine]]</span><br><span class="line">train_y = dataset_y[index[<span class="number">0</span>:splitLine]] </span><br><span class="line">test_x = dataset_x[index[splitLine:num]]</span><br><span class="line">test_y = dataset_y[index[splitLine:num]]</span><br></pre></td></tr></table></figure>

<p> Encode the classes into one-hot encoding.<br>For example,<br>0→[1,0,0]<br>1→[0,1,0]<br>2→[0,0,1] </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># One-Hot Encoding</span></span><br><span class="line">train_y_onehot = keras.utils.to_categorical(train_y, <span class="number">3</span>)</span><br><span class="line">test_y_onehot = keras.utils.to_categorical(test_y, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>Let’s observe the trainset and testset in different marker.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#put the trainset and testset in one graph to compare</span></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>,<span class="number">6</span>))</span><br><span class="line"><span class="comment">#the "+" means trainset</span></span><br><span class="line"><span class="comment">#different colours mean different kinds of iris</span></span><br><span class="line">plt.scatter(train_x[train_y==<span class="number">0</span>, <span class="number">0</span>], train_x[train_y==<span class="number">0</span>, <span class="number">1</span>], marker=<span class="string">'+'</span>, color=<span class="string">'red'</span>)</span><br><span class="line">plt.scatter(train_x[train_y==<span class="number">1</span>, <span class="number">0</span>], train_x[train_y==<span class="number">1</span>, <span class="number">1</span>], marker=<span class="string">'+'</span>, color=<span class="string">'green'</span>)</span><br><span class="line">plt.scatter(train_x[train_y==<span class="number">2</span>, <span class="number">0</span>], train_x[train_y==<span class="number">2</span>, <span class="number">1</span>], marker=<span class="string">'+'</span>, color=<span class="string">'blue'</span>)</span><br><span class="line"><span class="comment"># "v" means testset</span></span><br><span class="line">plt.scatter(test_x[test_y==<span class="number">0</span>, <span class="number">0</span>], test_x[test_y==<span class="number">0</span>, <span class="number">1</span>], marker=<span class="string">'v'</span>, color=<span class="string">'red'</span>)</span><br><span class="line">plt.scatter(test_x[test_y==<span class="number">1</span>, <span class="number">0</span>], test_x[test_y==<span class="number">1</span>, <span class="number">1</span>], marker=<span class="string">'v'</span>, color=<span class="string">'green'</span>)</span><br><span class="line">plt.scatter(test_x[test_y==<span class="number">2</span>, <span class="number">0</span>], test_x[test_y==<span class="number">2</span>, <span class="number">1</span>], marker=<span class="string">'v'</span>, color=<span class="string">'blue'</span>)</span><br><span class="line">plt.legend((<span class="string">"train_setosa"</span>,<span class="string">"train_versicolor"</span>,<span class="string">"train_virginica"</span>,<span class="string">"test_setosa"</span>,<span class="string">"test_versicolor"</span>,<span class="string">"test_virginica"</span>)) <span class="comment">#plot the label</span></span><br><span class="line">plt.xlabel(<span class="string">'petal_length'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'petal_width'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.ax1x.com/2020/03/08/3zc16P.png" alt="3zc16P.png"></p>
<h2 id="3-Describe-your-neural-network"><a href="#3-Describe-your-neural-network" class="headerlink" title="3 Describe your neural network"></a>3 Describe your neural network</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># describe the model</span></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    layers.Dense(units=<span class="number">64</span>, activation=<span class="string">'relu'</span>, input_shape=(<span class="number">2</span>,)),</span><br><span class="line">    layers.Dense(units=<span class="number">64</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">    layers.Dense(units=<span class="number">3</span>, activation=<span class="string">'softmax'</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Model: &quot;sequential_1&quot;</span><br><span class="line">_________________________________________________________________</span><br><span class="line">Layer (type)                 Output Shape              Param #   </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">dense_3 (Dense)              (None, 64)                192       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dense_4 (Dense)              (None, 64)                4160      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dense_5 (Dense)              (None, 3)                 195       </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Total params: 4,547</span><br><span class="line">Trainable params: 4,547</span><br><span class="line">Non-trainable params: 0</span><br><span class="line">_________________________________________________________________</span><br></pre></td></tr></table></figure>

<p> We can use <strong>Mean Square Error (MSE)</strong> as <code>loss</code> function, and use <strong>Stochastic Gradient Descent (SGD)</strong> as the process we train the model (i.e. “<code>optimizer</code>“).<br>(PS: MSE is not so suitable for classification) </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.compile(loss=<span class="string">'mse'</span>, optimizer=<span class="string">'sgd'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="4-Training"><a href="#4-Training" class="headerlink" title="4 Training"></a>4 Training</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">model.fit(train_x, train_y_onehot, batch_size=<span class="number">4</span>, epochs=<span class="number">100</span>, verbose=<span class="number">1</span>)</span><br><span class="line"><span class="comment">#fit( x, y, batch_size=32, epochs=10, verbose=1, callbacks=None,validation_split=0.0, validation_data=None, shuffle=True, class_weight=None, sample_weight=None, initial_epoch=0)</span></span><br></pre></td></tr></table></figure>

<h2 id="5-Evaluation-of-the-trained-model"><a href="#5-Evaluation-of-the-trained-model" class="headerlink" title="5 Evaluation of the trained model"></a>5 Evaluation of the trained model</h2><p>We can use <code>.evaluate</code> to compute <strong>loss</strong> on testset.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cost = model.evaluate(test_x, test_y_onehot)</span><br><span class="line">print(<span class="string">'test cost:'</span>, cost) <span class="comment">#find the cost(difference to the real value)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scores = model.predict(test_x)<span class="comment">#predict the next five value</span></span><br><span class="line">print(scores)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">results = np.array([])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> scores:</span><br><span class="line">    results = np.append(results, np.argmax(i))</span><br><span class="line">print(results)</span><br><span class="line"><span class="comment">#out:[0. 2. 0. 2. 1. 2. 1. 1. 2. 2. 2. 2. 0. 0. 1. 2. 2. 0. 2. 0. 2. 2. 1. 1. 0. 2. 2. 1. 1. 1.]</span></span><br></pre></td></tr></table></figure>

<p> Visualize our model of prediction. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># draw ground truth</span></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">plt.scatter(test_x[test_y==<span class="number">0</span>, <span class="number">0</span>], test_x[test_y==<span class="number">0</span>, <span class="number">1</span>], marker=<span class="string">'v'</span>, color=<span class="string">'red'</span>)</span><br><span class="line">plt.scatter(test_x[test_y==<span class="number">1</span>, <span class="number">0</span>], test_x[test_y==<span class="number">1</span>, <span class="number">1</span>], marker=<span class="string">'v'</span>, color=<span class="string">'green'</span>)</span><br><span class="line">plt.scatter(test_x[test_y==<span class="number">2</span>, <span class="number">0</span>], test_x[test_y==<span class="number">2</span>, <span class="number">1</span>], marker=<span class="string">'v'</span>, color=<span class="string">'blue'</span>)</span><br><span class="line">plt.legend((<span class="string">"setosa"</span>,<span class="string">"versicolor"</span>,<span class="string">"virginica"</span>))</span><br><span class="line">plt.xlabel(<span class="string">'petal_length'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'petal_width'</span>)</span><br><span class="line">plt.title(<span class="string">'Ground Truth of Testset'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># draw prediction</span></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">plt.scatter(test_x[results==<span class="number">0</span>, <span class="number">0</span>], test_x[results==<span class="number">0</span>, <span class="number">1</span>], color=<span class="string">'red'</span>)</span><br><span class="line">plt.scatter(test_x[results==<span class="number">1</span>, <span class="number">0</span>], test_x[results==<span class="number">1</span>, <span class="number">1</span>], color=<span class="string">'green'</span>)</span><br><span class="line">plt.scatter(test_x[results==<span class="number">2</span>, <span class="number">0</span>], test_x[results==<span class="number">2</span>, <span class="number">1</span>], color=<span class="string">'blue'</span>)</span><br><span class="line">plt.legend((<span class="string">"setosa"</span>,<span class="string">"versicolor"</span>,<span class="string">"virginica"</span>))</span><br><span class="line">plt.xlabel(<span class="string">'petal_length'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'petal_width'</span>)</span><br><span class="line">plt.title(<span class="string">'Prediction of Testset'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># draw classiication areas</span></span><br><span class="line">x = np.arange(min(test_x[:,<span class="number">0</span>]), max(test_x[:,<span class="number">0</span>]), <span class="number">0.05</span>)</span><br><span class="line">y = np.arange(min(test_x[:,<span class="number">1</span>]), max(test_x[:,<span class="number">1</span>]), <span class="number">0.05</span>)</span><br><span class="line">X,Y = np.meshgrid(x,y)</span><br><span class="line">grid = np.array((X.flatten(), Y.flatten())).T</span><br><span class="line">scores_1 = model.predict(grid)</span><br><span class="line">decisions = np.array([])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> scores_1:</span><br><span class="line">    decisions = np.append(decisions, np.argmax(i))</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">plt.scatter(grid[decisions==<span class="number">0</span>, <span class="number">0</span>], grid[decisions==<span class="number">0</span>, <span class="number">1</span>], color=<span class="string">'red'</span>)</span><br><span class="line">plt.scatter(grid[decisions==<span class="number">1</span>, <span class="number">0</span>], grid[decisions==<span class="number">1</span>, <span class="number">1</span>], color=<span class="string">'green'</span>)</span><br><span class="line">plt.scatter(grid[decisions==<span class="number">2</span>, <span class="number">0</span>], grid[decisions==<span class="number">2</span>, <span class="number">1</span>], color=<span class="string">'blue'</span>)</span><br><span class="line">plt.legend((<span class="string">"setosa"</span>,<span class="string">"versicolor"</span>,<span class="string">"virginica"</span>))</span><br><span class="line">plt.xlabel(<span class="string">'petal_length'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'petal_width'</span>)</span><br><span class="line">plt.title(<span class="string">'Classification Areas'</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.ax1x.com/2020/03/08/3zgTvq.png" alt="3zgTvq.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/03/23/%E6%9C%89%E5%85%B3%E6%B5%B7%E5%8D%8EAI%E6%AF%94%E8%B5%9B3/" data-id="ckbw9eiql001d34ur7v4qf59t" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Competition/" rel="tag">Competition</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Testing/">Testing</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/daily/">daily</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B5%B7%E5%8D%8EAI-competition/">海华AI competition</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/NumPy/" rel="tag">-NumPy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">-python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/translation/" rel="tag">-translation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vb/" rel="tag">-vb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Competition/" rel="tag">Competition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/NumPy/" style="font-size: 10px;">-NumPy</a> <a href="/tags/python/" style="font-size: 20px;">-python</a> <a href="/tags/translation/" style="font-size: 13.33px;">-translation</a> <a href="/tags/vb/" style="font-size: 10px;">-vb</a> <a href="/tags/Competition/" style="font-size: 16.67px;">Competition</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/06/26/%E7%B2%97%E8%AF%BB%E9%80%BB%E8%BE%91%E5%AD%A6logic/">粗读逻辑学logic</a>
          </li>
        
          <li>
            <a href="/2020/06/26/python%E5%AD%A6%E4%B9%A05/">python学习5</a>
          </li>
        
          <li>
            <a href="/2020/06/19/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2020/06/19/matplotlib%E5%AD%A6%E4%B9%A0/">matplotlib学习</a>
          </li>
        
          <li>
            <a href="/2020/06/07/Python-%E5%AD%A6%E4%B9%A04/">Python-学习4</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>